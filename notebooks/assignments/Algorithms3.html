
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Algorithms Homework 3 &#8212; Optimization for Decision Science</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'notebooks/assignments/Algorithms3';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Algorithms Homework 4" href="Algorithms4.html" />
    <link rel="prev" title="Project 2" href="../../org/project2.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/cbe_logo.jpg" class="logo__image only-light" alt="Optimization for Decision Science - Home"/>
    <script>document.write(`<img src="../../_static/cbe_logo.jpg" class="logo__image only-dark" alt="Optimization for Decision Science - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    Optimization for Decision Science
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Organization</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../org/intro.html">Welcome</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../org/syllabus.html">Syllabus</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../org/calendar.html">Fall 2024 Calendar</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../org/contribute.html">Contribution Instructions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../org/workshop.html">Computational Optimization in Python (SÃ£o Paulo, Brazil)</a></li>
</ul>
</details></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../../org/assignments.html">Assignments</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="Pyomo1.html">Pyomo Homework 1</a></li>
<li class="toctree-l2"><a class="reference internal" href="Pyomo2.html">Pyomo Homework 2</a></li>
<li class="toctree-l2"><a class="reference internal" href="Pyomo3.html">Pyomo Homework 3</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../org/project1.html">Project 1</a></li>
<li class="toctree-l2"><a class="reference internal" href="Algorithms1.html">Algorithms Homework 1</a></li>
<li class="toctree-l2"><a class="reference internal" href="Algorithms2.html">Algorithms Homework 2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../org/project2.html">Project 2</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Algorithms Homework 3</a></li>
<li class="toctree-l2"><a class="reference internal" href="Algorithms4.html">Algorithms Homework 4</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../org/archive.html">Archive</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="Pyomo-Mini-Project.html">Pyomo Mini-Project: Receding Horizon Stochastic Control</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../org/semester_project.html">Semester Project (Spring 2023)</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Optimization Modeling in Pyomo</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../1/getting-started.html">1. Getting Started with Pyomo</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../1/Local-Install.html">1.1. Local Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1/Optimization-Modeling.html">1.2. Optimization Modeling with Applications</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1/Pyomo-Introduction.html">1.3. Your First Optimization Problem</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1/LP.html">1.4. Continuous Optimization: Linear Programming</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1/NLP.html">1.5. Continuous Optimization: Nonlinear Programming</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1/IP.html">1.6. Integer Programs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1/Pyomo-Nuts-and-Bolts.html">1.7. 60 Minutes to Pyomo: An Energy Storage Model Predictive Control Example</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../2/logic.html">2. Logical Modeling</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../2/Logical_Modeling_GDP.html">2.1. Logical Modeling and Generalized Disjunctive Programs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2/Modeling_Disjunctions_Strip_Packing.html">2.2. Modeling Disjunctions through the Strip Packing Problem</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../3/dynamics.html">3. Dynamic Optimization</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../3/PyomoDAE_car.html">3.1. Pyomo.DAE Example: Race Car</a></li>
<li class="toctree-l2"><a class="reference internal" href="../3/PyomoDAE_TCLab.html">3.2. Pyomo.DAE Example: Temperature Control Lab</a></li>
<li class="toctree-l2"><a class="reference internal" href="../3/DAE_background.html">3.3. Differential Algebraic Equations (DAEs)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../3/DAE_numeric_integration.html">3.4. Numeric Integration for DAEs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../3/PyomoDAE_theory.html">3.5. Dynamic Optimization with Collocation and Pyomo.DAE</a></li>
<li class="toctree-l2"><a class="reference internal" href="../3/PyomoDAE_example.html">3.6. Pyomo.DAE: Racing Example Revisited</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../4/uncertainty.html">4. Optimization Under Uncertainty</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../4/SP.html">4.1. Stochastic Programming</a></li>
<li class="toctree-l2"><a class="reference internal" href="../4/blocks.html">4.2. Blocks and Other Pyomo Best Practices</a></li>
<li class="toctree-l2"><a class="reference internal" href="../4/AdvancedTopics.html">4.3. Advanced Topics in Stochastic Programming</a></li>
<li class="toctree-l2"><a class="reference internal" href="../4/RiskMeasures.html">4.4. Risk Measures and Portfolio Optimization</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../5/data.html">5. Data Science and Applied Statistics</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../5/Parmest-tutorial.html">5.1. Parameter estimation with <code class="docutils literal notranslate"><span class="pre">parmest</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../5/Parmest-generate-data.html">5.2. Supplementary material: data for parmest tutorial</a></li>
<li class="toctree-l2"><a class="reference internal" href="../5/Pyomo_DoE_Tutorial.html">5.3. Optimizing Experiments with <code class="docutils literal notranslate"><span class="pre">Pyomo.DoE</span></code></a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Algorithms and Theory</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../6/unconstrained.html">6. Unconstrained Nonlinear Optimization</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../6/Math-Primer-1.html">6.1. Linear Algebra Review and SciPy Basics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../6/Math-Primer-2.html">6.2. Mathematics Primer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../6/Optimality.html">6.3. Unconstrained Optimality Conditions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../6/Newton-Methods.html">6.4. Newton-type Methods for Unconstrained Optimization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../6/Quasi-Newton-Methods.html">6.5. Quasi-Newton Methods for Unconstrained Optimization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../6/Globalization.html">6.6. Descent and Globalization</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../7/constrained.html">7. Constrained Nonlinear Optimization</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../7/Convexity.html">7.1. Convexity Revisited</a></li>
<li class="toctree-l2"><a class="reference internal" href="../7/Local-Optimality.html">7.2. Local Optimality Conditions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../7/KKT-Multipliers.html">7.3. Analysis of KKT Conditions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../7/Constraint-Qualifications.html">7.4. Constraint Qualifications</a></li>
<li class="toctree-l2"><a class="reference internal" href="../7/Second-Order.html">7.5. Second Order Optimality Conditions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../7/degeneracy_hunter.html">7.6. NLP Diagnostics with Degeneracy Hunter</a></li>
<li class="toctree-l2"><a class="reference internal" href="../7/Interior-Point1.html">7.7. Simple Netwon Method for Equality Constrained NLPs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../7/Interior-Point2.html">7.8. Inertia-Corrected Netwon Method for Equality Constrained NLPs</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../8/special-topics.html">8. Special Topics</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../8/MILP.html">8.1. Integer Programming with Simple Branch and Bound</a></li>
<li class="toctree-l2"><a class="reference internal" href="../8/MINLP-Algorithms.html">8.2. MINLP Algorithms</a></li>
<li class="toctree-l2"><a class="reference internal" href="../8/Global-Opt.html">8.3. Deterministic Global Optimization</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Student Contributions</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../contrib/pyomo.html">More Pyomo Examples</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../contrib/semiconductor_manufacturing.html">Semiconductor Production Planning</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contrib/student_diet.html">Optimization of Daily Diet Using Pyomo</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contrib/blending.html">Blending Under Uncertainty</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contrib/vehicle_routing.html">Vehicle Routing</a></li>

<li class="toctree-l2"><a class="reference internal" href="../contrib/portfolio_optimization_extended.html">Risk Measures and Portfolio Optimization: Expanded</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contrib/race_car_extended.html">Extended Race Car Optimization Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contrib/hot_air_balloon.html">Hot Air Balloon Dynamic Control</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contrib/reactor_design.html">Chemical Reactor Design</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contrib/Disaster_Response_Plan.html">Disaster Response Plan Optimization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contrib/Sudoku_Solver.html">Sudoku Solver</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contrib/more_circle_packing.html">Circle Packing Optimization</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../contrib/modeling.html">Modeling Paradigms</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../contrib/multi_objective.html">Multi-Objective Optimization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contrib/advanced_stochastic_programming.html">Advanced Topics in Stochastic Programming</a></li>






</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../contrib/algorithms.html">Global Optimization</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../contrib/Deterministic_Global_Optimization.html">Deterministic Global Optimization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contrib/Bayesian_Optimization1.html">Bayesian Optimization Tutorial 1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contrib/Bayesian_Optimization2.html">Bayesian Optimization Tutorial 2</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../contrib/sgd.html">Stochastic Gradient Descent</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../contrib/Stochastic-Gradient-Descent-1.html">Stochastic Gradient Descent Tutorial 1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contrib/Stochastic-Gradient-Descent-2.html">Stochastic Gradient Descent Tutorial 2</a></li>






<li class="toctree-l2"><a class="reference internal" href="../contrib/Stochastic-Gradient-Descent-3.html">Stochastic Gradient Descent Tutorial 3</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../contrib/data.html">Machine Learning and Applied Statistics</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../contrib/EM-MAP.html">Expectation Maximization Algorithm and MAP Estimation</a></li>
</ul>
</details></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://colab.research.google.com/github/ndcbe/optimization/blob/master/notebooks/assignments/Algorithms3.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Colab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Colab logo" src="../../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/ndcbe/optimization" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/ndcbe/optimization/issues/new?title=Issue%20on%20page%20%2Fnotebooks/assignments/Algorithms3.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/notebooks/assignments/Algorithms3.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Algorithms Homework 3</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pseudocode">Pseudocode</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#unconstrained-nlp-algorithm-in-python">Unconstrained NLP Algorithm in Python</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#library-of-helper-functions">Library of Helper Functions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#main-function">Main Function</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#feature-status">Feature Status</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sr1">SR1</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#bfgs">BFGS</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#line-search">Line Search</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#trust-region">Trust Region</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#benchmark-tests">Benchmark Tests</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#quadratic-test-problem">Quadratic Test Problem</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#benchmark-cases">Benchmark Cases</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#discussion-and-analysis">Discussion and Analysis</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#one-dimensional-example">One-Dimensional Example</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#benchmark-cases-with-x-0-3">Benchmark Cases with <span class="math notranslate nohighlight">\(x_0 = -3\)</span></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#discussion">Discussion</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#benchmark-case-with-x-0-0">Benchmark Case with <span class="math notranslate nohighlight">\(x_0 = 0\)</span></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Discussion</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#return-of-example-2-19">Return of Example 2.19</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#benchmark-with-x-0-near-solution">Benchmark with <span class="math notranslate nohighlight">\(x_0\)</span> Near Solution</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Discussion</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#benchmark-with-x-0-far-from-the-solution">Benchmark with <span class="math notranslate nohighlight">\(x_0\)</span> Far From the Solution</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">Discussion</a></li>
</ul>
</li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="algorithms-homework-3">
<h1>Algorithms Homework 3<a class="headerlink" href="#algorithms-homework-3" title="Link to this heading">#</a></h1>
<p><strong>Assignment Overview:</strong> In this assignment, we will complete the function <code class="docutils literal notranslate"><span class="pre">unconstrained_newton</span></code> which implements four Hessian options (exact, SR1 approximation, BFGS approximation, steepest descent) and three globalization strategies (none, line search, trust region). We will then compare 10 algorithm variations on three test problems.</p>
<p>The best way to really learn the algorithms discussed in lecture is to implement them yourselves. Creating a function like <code class="docutils literal notranslate"><span class="pre">unconstrained_newton</span></code> from scratch takes a lot of time and comfort with Python. Instead, we will start with fairly complete version of <code class="docutils literal notranslate"><span class="pre">unconstrained_newton</span></code>. You will need to fill in the following details:</p>
<ul class="simple">
<li><p>BFGS Hessian approximation</p></li>
<li><p>Backtracking line search with Armijo-Goldstein conditions</p></li>
<li><p>Trust region with Powell dogleg step</p></li>
</ul>
<p>This assignment could take a long time, especially if you are still learning Python. Recognizing this, we will try a new grading policy for this assignment.</p>
<p><strong>Instructions</strong>: To be eligible for full credit on the assignment, you need to:</p>
<ol class="arabic simple">
<li><p>Complete all requested pseudocode</p></li>
<li><p>Spend an honest <strong>6 hours</strong> (4 hours for CBE 40499) total working on Python implementation.</p></li>
<li><p>Be sure to complete the <strong>Feature Status</strong> subsection.</p></li>
<li><p>The (hopefully) correct results for the test cases are available online in this notebook. Answer the questions using these results.</p></li>
</ol>
<section id="pseudocode">
<h2>Pseudocode<a class="headerlink" href="#pseudocode" title="Link to this heading">#</a></h2>
<p>After reading through the entire assignment, please prepare pseudocode for the following functions/algorithms:</p>
<ol class="arabic simple">
<li><p>SR1 update (Python code is provided. Going from code to pseudocode is good practice.)</p></li>
<li><p>BFGS update</p></li>
<li><p>Line search</p></li>
<li><p>Trust region</p></li>
</ol>
<p>Please turn in this pseudocode via Gradescope.</p>
<p><strong>Reminder:</strong> pseudocode should not look like Python code copied to paper. Instead, pseudocode should clearly communicate the main steps of the algorithm with flow logic. Add lots of comments. It should not be programming language specific.</p>
</section>
<section id="unconstrained-nlp-algorithm-in-python">
<h2>Unconstrained NLP Algorithm in Python<a class="headerlink" href="#unconstrained-nlp-algorithm-in-python" title="Link to this heading">#</a></h2>
<section id="library-of-helper-functions">
<h3>Library of Helper Functions<a class="headerlink" href="#library-of-helper-functions" title="Link to this heading">#</a></h3>
<p>Below is a library of helpful functions. Most of these came from in class examples.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Load required Python libraries.</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy</span><span class="w"> </span><span class="kn">import</span> <span class="n">linalg</span>

<span class="c1">## Check is element of array is NaN</span>
<span class="k">def</span><span class="w"> </span><span class="nf">check_nan</span><span class="p">(</span><span class="n">A</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">A</span><span class="p">))</span>

<span class="c1">## Calculate gradient with central finite difference</span>
<span class="k">def</span><span class="w"> </span><span class="nf">my_grad_approx</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">f</span><span class="p">,</span><span class="n">eps1</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Calculate gradient of function my_f using central difference formula</span>
<span class="sd">    </span>
<span class="sd">    Inputs:</span>
<span class="sd">        x - point for which to evaluate gradient</span>
<span class="sd">        f - function to consider</span>
<span class="sd">        eps1 - perturbation size</span>
<span class="sd">        </span>
<span class="sd">    Outputs:</span>
<span class="sd">        grad - gradient (vector)</span>
<span class="sd">    &#39;&#39;&#39;</span>
    
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">grad</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    
    <span class="k">if</span><span class="p">(</span><span class="n">verbose</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;***** my_grad_approx at x = &quot;</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="s2">&quot;*****&quot;</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">n</span><span class="p">):</span>
        
        <span class="c1"># Create vector of zeros except eps in position i</span>
        <span class="n">e</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
        <span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">eps1</span>
        
        <span class="c1"># Finite difference formula</span>
        <span class="n">my_f_plus</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">e</span><span class="p">)</span>
        <span class="n">my_f_minus</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">e</span><span class="p">)</span>
        
        <span class="c1"># Diagnostics</span>
        <span class="k">if</span><span class="p">(</span><span class="n">verbose</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;e[&quot;</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="s2">&quot;] = &quot;</span><span class="p">,</span><span class="n">e</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;f(x + e[&quot;</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="s2">&quot;]) = &quot;</span><span class="p">,</span><span class="n">my_f_plus</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;f(x - e[&quot;</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="s2">&quot;]) = &quot;</span><span class="p">,</span><span class="n">my_f_minus</span><span class="p">)</span>
        
        
        <span class="n">grad</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">my_f_plus</span> <span class="o">-</span> <span class="n">my_f_minus</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">eps1</span><span class="p">)</span>
    
    <span class="k">if</span><span class="p">(</span><span class="n">verbose</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;***** Done. ***** </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">grad</span>

<span class="c1">## Calculate gradient using central finite difference and my_hes_approx</span>
<span class="k">def</span><span class="w"> </span><span class="nf">my_hes_approx</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">grad</span><span class="p">,</span><span class="n">eps2</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Calculate Hessian of function my_f using central difference formula and my_grad</span>
<span class="sd">    </span>
<span class="sd">    Inputs:</span>
<span class="sd">        x - point for which to evaluate gradient</span>
<span class="sd">        grad - function to calculate the gradient</span>
<span class="sd">        eps2 - perturbation size (for Hessian NOT gradient approximation)</span>
<span class="sd">        </span>
<span class="sd">    Outputs:</span>
<span class="sd">        H - Hessian (matrix)</span>
<span class="sd">    &#39;&#39;&#39;</span>
    
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">H</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">n</span><span class="p">,</span><span class="n">n</span><span class="p">])</span>
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">n</span><span class="p">):</span>
        <span class="c1"># Create vector of zeros except eps in position i</span>
        <span class="n">e</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
        <span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">eps2</span>
        
        <span class="c1"># Evaluate gradient twice</span>
        <span class="n">grad_plus</span> <span class="o">=</span> <span class="n">grad</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">e</span><span class="p">)</span>
        <span class="n">grad_minus</span> <span class="o">=</span> <span class="n">grad</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">e</span><span class="p">)</span>
        
        <span class="c1"># Notice we are building the Hessian by column (or row)</span>
        <span class="n">H</span><span class="p">[:,</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">grad_plus</span> <span class="o">-</span> <span class="n">grad_minus</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">eps2</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">H</span>

<span class="c1">## Linear algebra calculation</span>
<span class="k">def</span><span class="w"> </span><span class="nf">xxT</span><span class="p">(</span><span class="n">u</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Calculates u*u.T to circumvent limitation with SciPy</span>
<span class="sd">    </span>
<span class="sd">    Arguments:</span>
<span class="sd">    u - numpy 1D array</span>
<span class="sd">    </span>
<span class="sd">    Returns:</span>
<span class="sd">    u*u.T</span>
<span class="sd">    </span>
<span class="sd">    Assume u is a nx1 vector.</span>
<span class="sd">    Recall: NumPy does not distinguish between row or column vectors</span>
<span class="sd">    </span>
<span class="sd">    u.dot(u) returns a scalar. This functon returns an nxn matrix.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>
    <span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">n</span><span class="p">,</span><span class="n">n</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">n</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">n</span><span class="p">):</span>
            <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">u</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">u</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
    
    <span class="k">return</span> <span class="n">A</span>

<span class="c1">## Analyze Hessian</span>
<span class="k">def</span><span class="w"> </span><span class="nf">analyze_hes</span><span class="p">(</span><span class="n">B</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">B</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
    
    <span class="n">l</span> <span class="o">=</span> <span class="n">linalg</span><span class="o">.</span><span class="n">eigvals</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Eigenvalues: &quot;</span><span class="p">,</span><span class="n">l</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="main-function">
<h3>Main Function<a class="headerlink" href="#main-function" title="Link to this heading">#</a></h3>
<p>Below is the main function. You need to complete details in four functions.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">unconstrained_newton</span><span class="p">(</span><span class="n">calc_f</span><span class="p">,</span><span class="n">calc_grad</span><span class="p">,</span><span class="n">calc_hes</span><span class="p">,</span><span class="n">x0</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">max_iter</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
                         <span class="n">algorithm</span><span class="o">=</span><span class="s2">&quot;newton&quot;</span><span class="p">,</span><span class="n">globalization</span><span class="o">=</span><span class="s2">&quot;line-search&quot;</span><span class="p">,</span> <span class="c1"># specify algorithm</span>
                         <span class="n">eps_dx</span><span class="o">=</span><span class="mf">1E-6</span><span class="p">,</span><span class="n">eps_df</span><span class="o">=</span><span class="mf">1E-6</span><span class="p">,</span> <span class="c1"># Convergence tolerances (all)</span>
                         <span class="n">eta_ls</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span><span class="n">rho_ls</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span><span class="n">alpha_max</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="c1"># line search parameters</span>
                         <span class="n">delta_max_tr</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span><span class="n">delta_0_tr</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="c1"># trust region parameters</span>
                         <span class="n">kappa_1_tr</span> <span class="o">=</span> <span class="mf">0.25</span><span class="p">,</span> <span class="n">kappa_2_tr</span> <span class="o">=</span> <span class="mf">0.75</span><span class="p">,</span> <span class="n">gamma_tr</span><span class="o">=</span><span class="mf">0.125</span> <span class="c1"># trust region parameters</span>
                        <span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Newton-Type Methods for Unconstrained Nonlinear Continuous Optimization</span>
<span class="sd">    </span>
<span class="sd">    Arguments (required):</span>
<span class="sd">        calc_f : function f(x) to minimize [scalar]</span>
<span class="sd">        calc_grad: gradient of f(x) [vector]</span>
<span class="sd">        calc_hes: Hessian of f(x) [matrix]</span>
<span class="sd">    </span>
<span class="sd">    Arguments (options):</span>
<span class="sd">        algorithm : specify main algorithm.</span>
<span class="sd">            choices: &quot;newton&quot;, &quot;sr1&quot;, &quot;bfgs&quot;, &quot;steepest-descent&quot;</span>
<span class="sd">        </span>
<span class="sd">        globalization : specify globalization strategy</span>
<span class="sd">            choices: &quot;none&quot;, &quot;line-search&quot;, &quot;trust-region&quot;</span>
<span class="sd">       </span>
<span class="sd">        eps_dx : tolerance for step size norm (convergence), eps1 in notes</span>
<span class="sd">        </span>
<span class="sd">        eps_df : tolerance for gradient norm (convergence), eps2 in notes</span>
<span class="sd">        </span>
<span class="sd">        eta_ls : parameter for Goldstein-Armijo conditions (line search only)</span>
<span class="sd">        </span>
<span class="sd">        rho_ls : parameter to shrink (backstep) line search</span>
<span class="sd">        </span>
<span class="sd">        alpha_max : initial step length scaling for line search and/or steepest-descent</span>
<span class="sd">    </span>
<span class="sd">        delta_max_tr : maximum trust region size</span>
<span class="sd">        </span>
<span class="sd">        delta_0_tr : initial trust region size</span>
<span class="sd">        </span>
<span class="sd">        kappa_1_tr : &#39;shrink&#39; tolerance for trust region</span>
<span class="sd">        </span>
<span class="sd">        kappa_2_tr : &#39;expand&#39; tolerance for trust region</span>
<span class="sd">        </span>
<span class="sd">        gamma_tr : &#39;accept step&#39; tolerance for trust region</span>
<span class="sd">    </span>
<span class="sd">    Returns:</span>
<span class="sd">        x : iteration history for x (decision variables) [list of numpy arrays]</span>
<span class="sd">        f : iteration history for f(x) (objective values) [list of numpy arrays]</span>
<span class="sd">        p : iteration history for p (steps)</span>
<span class="sd">        B : iteration history for Hessian approximations [list of numpy arrays]</span>
<span class="sd">    &#39;&#39;&#39;</span>
    
    <span class="c1"># Allocate outputs as empty lists</span>
    <span class="n">x</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># decision variables</span>
    <span class="n">f</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># objective values</span>
    <span class="n">p</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># steps</span>
    <span class="n">grad</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># gradients</span>
    <span class="n">alpha</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># line search / steepest descent step scalar</span>
    <span class="n">B</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># Hessian approximation</span>
    <span class="n">delta</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># trust region size</span>
    <span class="n">rho</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># trust region actual/prediction ratio</span>
    <span class="n">step_accepted</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># step status for trust region. True means accepted. False means rejected.</span>
    
    <span class="c1"># Note: alpha, delta and rho will remain empty lists unless used in the algorithm below</span>
    
    <span class="c1"># Store starting point</span>
    <span class="n">x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x0</span><span class="p">)</span>
    <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span>
    
    <span class="n">flag</span> <span class="o">=</span> <span class="kc">True</span>
    
    <span class="c1"># Print header for iteration information</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Iter. </span><span class="se">\t</span><span class="s2">f(x) </span><span class="se">\t\t</span><span class="s2">||grad(x)|| </span><span class="se">\t</span><span class="s2">||p|| </span><span class="se">\t\t</span><span class="s2">min(eig(B)) </span><span class="se">\t</span><span class="s2">alpha </span><span class="se">\t\t</span><span class="s2">delta </span><span class="se">\t\t</span><span class="s2">step&quot;</span><span class="p">)</span>
    
    <span class="k">while</span> <span class="n">flag</span> <span class="ow">and</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="n">max_iter</span><span class="p">:</span>
        <span class="c1"># Evaluate f(x) at current iteration</span>
        <span class="n">f</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">calc_f</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span>
        
        <span class="c1"># Evaluate gradient</span>
        <span class="n">grad</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">calc_grad</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span>
        
        <span class="k">if</span><span class="p">(</span><span class="n">check_nan</span><span class="p">(</span><span class="n">grad</span><span class="p">[</span><span class="n">k</span><span class="p">])):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;WARNING: gradiant calculation returned NaN&quot;</span><span class="p">)</span>
            <span class="k">break</span>
        
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;k = &quot;</span><span class="p">,</span><span class="n">k</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;x = &quot;</span><span class="p">,</span><span class="n">x</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;grad = &quot;</span><span class="p">,</span><span class="n">grad</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;f = &quot;</span><span class="p">,</span><span class="n">f</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>

        <span class="c1"># Calculate exact Hessian or update approximation</span>
        <span class="k">if</span><span class="p">(</span><span class="n">algorithm</span> <span class="o">==</span> <span class="s2">&quot;newton&quot;</span><span class="p">):</span>
            <span class="n">B</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">calc_hes</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span>
        
        <span class="k">elif</span> <span class="n">k</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">algorithm</span> <span class="o">==</span> <span class="s2">&quot;steepest-descent&quot;</span><span class="p">:</span>
            <span class="c1"># Initialize or set to identity</span>
            <span class="n">B</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x0</span><span class="p">)))</span>
        
        <span class="k">elif</span> <span class="n">algorithm</span> <span class="o">==</span> <span class="s2">&quot;sr1&quot;</span> <span class="ow">or</span> <span class="n">algorithm</span> <span class="o">==</span> <span class="s2">&quot;bfgs&quot;</span><span class="p">:</span>
            <span class="c1"># Change in x</span>
            <span class="n">s</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="n">x</span><span class="p">[</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

            <span class="c1"># Change in gradient</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">grad</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="n">grad</span><span class="p">[</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

            <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;s = &quot;</span><span class="p">,</span><span class="n">s</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;y = &quot;</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
            
            <span class="k">if</span> <span class="n">algorithm</span> <span class="o">==</span> <span class="s2">&quot;sr1&quot;</span><span class="p">:</span> <span class="c1"># Calculate SR1 update</span>
                <span class="n">dB</span> <span class="o">=</span> <span class="n">sr1_update</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">verbose</span><span class="p">)</span>
                <span class="n">B</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">B</span><span class="p">[</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dB</span><span class="p">)</span>
                
            <span class="k">else</span><span class="p">:</span> <span class="c1"># Calculate BFGS update  </span>
                <span class="n">dB</span> <span class="o">=</span> <span class="n">bfgs_update</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">verbose</span><span class="p">)</span>
                <span class="n">B</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">B</span><span class="p">[</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dB</span><span class="p">)</span> 

        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;WARNING. algorithm = &quot;</span><span class="p">,</span><span class="n">algorithm</span><span class="p">,</span><span class="s2">&quot; is not supported.&quot;</span><span class="p">)</span>
            <span class="k">break</span>

        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;B = </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="n">B</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;B[k].shape = &quot;</span><span class="p">,</span><span class="n">B</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
            
        <span class="k">if</span><span class="p">(</span><span class="n">check_nan</span><span class="p">(</span><span class="n">B</span><span class="p">[</span><span class="n">k</span><span class="p">])):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;WARNING: Hessian update returned NaN&quot;</span><span class="p">)</span>
            <span class="k">break</span>
            
        <span class="n">c</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">cond</span><span class="p">(</span><span class="n">B</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">c</span> <span class="o">&gt;</span> <span class="mf">1E12</span><span class="p">:</span>
            <span class="n">flag</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Warning: Hessian approximation is near singular.&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;B[k] = </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="n">B</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
        
        <span class="k">else</span><span class="p">:</span>
            
            <span class="c1"># Solve linear system to calculate step</span>
            <span class="n">pk</span> <span class="o">=</span> <span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">B</span><span class="p">[</span><span class="n">k</span><span class="p">],</span><span class="o">-</span><span class="n">grad</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
            
            <span class="k">if</span> <span class="n">globalization</span> <span class="o">==</span> <span class="s2">&quot;none&quot;</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">algorithm</span> <span class="o">==</span> <span class="s2">&quot;steepest-descent&quot;</span><span class="p">:</span>
                    <span class="c1"># Save step and scale by alpha_max</span>
                    <span class="n">p</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pk</span><span class="o">*</span><span class="n">alpha_max</span><span class="p">)</span>
                    
                <span class="k">else</span><span class="p">:</span>
                    <span class="c1"># Take full step</span>
                    <span class="n">p</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pk</span><span class="p">)</span>
                    
                <span class="c1"># Apply step and calculate x[k+1]</span>
                <span class="n">x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="n">p</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                    
            <span class="k">elif</span> <span class="n">globalization</span> <span class="o">==</span> <span class="s2">&quot;line-search&quot;</span><span class="p">:</span>
                
                <span class="c1"># Line Search Function</span>
                <span class="n">update</span><span class="p">,</span> <span class="n">alphak</span> <span class="o">=</span> <span class="n">line_search</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">grad</span><span class="p">,</span> <span class="n">calc_f</span><span class="p">,</span> <span class="n">pk</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">alpha_max</span><span class="p">,</span> <span class="n">eta_ls</span><span class="p">,</span> <span class="n">rho_ls</span><span class="p">,</span> <span class="n">verbose</span><span class="p">)</span>
                
                <span class="c1"># Now the line search is complete, apply final value of alphak</span>
                <span class="n">p</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">update</span><span class="p">)</span>
                
                <span class="c1"># Save alpha</span>
                <span class="n">alpha</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">alphak</span><span class="p">)</span>
                
                <span class="c1"># Apply step and calculate x[k+1]</span>
                <span class="n">x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="n">p</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
            
            <span class="k">elif</span> <span class="n">globalization</span> <span class="o">==</span> <span class="s2">&quot;trust-region&quot;</span><span class="p">:</span>
                
                <span class="c1"># Trust region function</span>
                <span class="n">update</span> <span class="o">=</span> <span class="n">trust_region</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">grad</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">delta</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">pk</span><span class="p">,</span> <span class="n">delta_0_tr</span><span class="p">,</span> <span class="n">verbose</span><span class="p">)</span>
                <span class="n">p</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">update</span><span class="p">)</span>
                
                <span class="c1">### Trust region management</span>

                <span class="c1"># Actual reduction</span>
                <span class="n">ared</span> <span class="o">=</span> <span class="n">f</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="n">calc_f</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="n">p</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>

                <span class="c1"># Predicted reduction</span>
                <span class="n">pred</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">grad</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">p</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">B</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="n">k</span><span class="p">])))</span>

                <span class="c1"># Calculate rho</span>
                <span class="k">if</span> <span class="n">ared</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">pred</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="c1"># This occurs is the gradient is zero and Hessian is P.D.</span>
                    <span class="n">rho</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">1E4</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">rho</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ared</span><span class="o">/</span><span class="n">pred</span><span class="p">)</span>

                <span class="k">if</span><span class="p">(</span><span class="n">verbose</span><span class="p">):</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;f[k] = &quot;</span><span class="p">,</span><span class="n">f</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;p[k] = &quot;</span><span class="p">,</span><span class="n">p</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;f(x[k] + p[k]) = &quot;</span><span class="p">,</span><span class="n">calc_f</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="n">p</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ared = &quot;</span><span class="p">,</span><span class="n">ared</span><span class="p">)</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;pred = &quot;</span><span class="p">,</span><span class="n">pred</span><span class="p">)</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;rho = &quot;</span><span class="p">,</span><span class="n">rho</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>

                <span class="c1">## Check trust region shrink/expand logic</span>
                <span class="k">if</span> <span class="n">rho</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">kappa_1_tr</span><span class="p">:</span>
                    <span class="c1"># Shrink trust region</span>
                    <span class="n">delta</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">kappa_1_tr</span><span class="o">*</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span>

                <span class="k">elif</span> <span class="n">rho</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">kappa_2_tr</span> <span class="ow">and</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">-</span> <span class="n">delta</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">&lt;</span> <span class="mf">1E-6</span><span class="p">:</span>
                    <span class="c1"># Expand trust region</span>
                    <span class="n">delta</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">([</span><span class="mi">2</span><span class="o">*</span><span class="n">delta</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">delta_max_tr</span><span class="p">]))</span>

                <span class="k">else</span><span class="p">:</span>
                    <span class="c1"># Keep trust region same size</span>
                    <span class="n">delta</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">delta</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>

                <span class="c1"># Compute step</span>
                <span class="k">if</span> <span class="n">rho</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">gamma_tr</span><span class="p">:</span>
                    <span class="c1"># Take step</span>
                    <span class="n">x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="n">p</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                    <span class="n">step_accepted</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="c1"># Skip step</span>
                    <span class="n">x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                    <span class="n">step_accepted</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Warning: globalization strategy not supported&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;p = &quot;</span><span class="p">,</span><span class="n">p</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>

            <span class="c1"># Calculate norms</span>
            <span class="n">norm_p</span> <span class="o">=</span> <span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
            <span class="n">norm_g</span> <span class="o">=</span> <span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">grad</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>

            <span class="c1"># Calculate eigenvalues of Hessian (for display only)</span>
            <span class="n">min_ev</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">linalg</span><span class="o">.</span><span class="n">eigvals</span><span class="p">(</span><span class="n">B</span><span class="p">[</span><span class="n">k</span><span class="p">])))</span>

<span class="w">            </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">            print(&quot;f[k] = &quot;,f[k])</span>
<span class="sd">            print(&quot;norm_g = &quot;,norm_g)</span>
<span class="sd">            print(&quot;norm_g = &quot;,norm_p)</span>
<span class="sd">            print(&quot;min_ev = &quot;,min_ev)</span>
<span class="sd">            &#39;&#39;&#39;</span>
            
            <span class="nb">print</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="s1">&#39;  </span><span class="se">\t</span><span class="si">{0: 1.4e}</span><span class="s1"> </span><span class="se">\t</span><span class="si">{1:1.4e}</span><span class="s1"> </span><span class="se">\t</span><span class="si">{2:1.4e}</span><span class="s1"> </span><span class="se">\t</span><span class="si">{3: 1.4e}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="n">k</span><span class="p">],</span><span class="n">norm_g</span><span class="p">,</span><span class="n">norm_p</span><span class="p">,</span><span class="n">min_ev</span><span class="p">),</span><span class="n">end</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>

            <span class="c1"># Python tip. The expression &#39;if my_list&#39; is false if &#39;my_list&#39; is empty</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">alpha</span><span class="p">:</span>
                <span class="c1"># alpha is an empty list</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39; </span><span class="se">\t</span><span class="s1"> -------&#39;</span><span class="p">,</span><span class="n">end</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># otherwise print value of alpha</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39; </span><span class="se">\t</span><span class="si">{0: 1.2e}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">alpha</span><span class="p">[</span><span class="n">k</span><span class="p">]),</span><span class="n">end</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
            
            <span class="k">if</span> <span class="ow">not</span> <span class="n">delta</span><span class="p">:</span>
                <span class="c1"># delta is an empty list</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39; </span><span class="se">\t</span><span class="s1"> -------&#39;</span><span class="p">,</span><span class="n">end</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># otherwise print value of alpha</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39; </span><span class="se">\t</span><span class="si">{0: 1.2e}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">delta</span><span class="p">[</span><span class="n">k</span><span class="p">]),</span><span class="n">end</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
                
            <span class="k">if</span> <span class="ow">not</span> <span class="n">step_accepted</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39; </span><span class="se">\t</span><span class="s1"> -----&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">step_accepted</span><span class="p">[</span><span class="n">k</span><span class="p">]:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39; </span><span class="se">\t</span><span class="s1"> accept&#39;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39; </span><span class="se">\t</span><span class="s1"> reject&#39;</span><span class="p">)</span>
            
            <span class="c1"># Check convergence criteria.</span>
            <span class="n">flag</span> <span class="o">=</span> <span class="p">(</span><span class="n">norm_p</span> <span class="o">&gt;</span> <span class="n">eps_dx</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">norm_g</span> <span class="o">&gt;</span> <span class="n">eps_df</span><span class="p">)</span>

            <span class="c1"># Update iteration counter</span>
            <span class="n">k</span> <span class="o">=</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span>
    
    <span class="k">if</span><span class="p">(</span><span class="n">k</span> <span class="o">==</span> <span class="n">max_iter</span> <span class="ow">and</span> <span class="n">flag</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Reached maximum number of iterations.&quot;</span><span class="p">)</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;x* = &quot;</span><span class="p">,</span><span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
    
    <span class="k">return</span> <span class="n">x</span><span class="p">,</span><span class="n">f</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">B</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">sr1_update</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">verbose</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; </span>
<span class="sd">    Function that implements the sr1 optimization algorithm</span>
<span class="sd">    </span>
<span class="sd">    Inputs:</span>
<span class="sd">    s : Change in x</span>
<span class="sd">    y : Change in gradient</span>
<span class="sd">    k : Iteration number</span>
<span class="sd">    B : Hessian approximation</span>
<span class="sd">    verbose : toggles verbose output (True or False)</span>
<span class="sd">    </span>
<span class="sd">    Outputs:</span>
<span class="sd">    dB : Update to Hessian approximation</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="c1"># SR1 formulation</span>
    <span class="n">u</span> <span class="o">=</span> <span class="n">y</span> <span class="o">-</span> <span class="n">B</span><span class="p">[</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
    <span class="n">denom</span> <span class="o">=</span> <span class="p">(</span><span class="n">u</span><span class="p">)</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>

    <span class="c1"># Formula: dB = u * u.T / (u.T * s) if u is a column vector.</span>
    <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">denom</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mf">1E-10</span><span class="p">:</span>
        <span class="c1"># Skip update</span>
        <span class="n">dB</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># Calculate update</span>
        <span class="n">dB</span> <span class="o">=</span> <span class="n">xxT</span><span class="p">(</span><span class="n">u</span><span class="p">)</span><span class="o">/</span><span class="n">denom</span>

    <span class="k">if</span><span class="p">(</span><span class="n">verbose</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;SR1 update denominator, (y-B[k-1]*s).T*s = &quot;</span><span class="p">,</span><span class="n">denom</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;SR1 update u = &quot;</span><span class="p">,</span><span class="n">u</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;SR1 update u.T*u/(u.T*s) = </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="n">dB</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">dB</span> <span class="c1">#return the update to the Hessian approximation</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">bfgs_update</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">verbose</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; </span>
<span class="sd">    Function that implements the BFGS optimization algorithm</span>
<span class="sd">    </span>
<span class="sd">    Inputs:</span>
<span class="sd">    s : Change in x</span>
<span class="sd">    y : Change in gradient</span>
<span class="sd">    k : Iteration number</span>
<span class="sd">    B : Hessian approximation</span>
<span class="sd">    verbose : toggles verbose output (True or False)</span>
<span class="sd">    </span>
<span class="sd">    Outputs:</span>
<span class="sd">    dB : Update to Hessian approximation</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="c1"># Define constant used to check norm of the update</span>
    <span class="c1"># See Eq. (3.19) in Biegler (2010)</span>
    <span class="n">C2</span> <span class="o">=</span> <span class="mf">1E-4</span>
    
    
    
    <span class="c1"># Calculate intermediate</span>
    <span class="n">sy</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
    
    <span class="c1"># Calculate Term 2 denominator</span>
    <span class="c1"># s.T * Bk * s</span>
    <span class="n">d2</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">B</span><span class="p">[</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">s</span><span class="p">))</span>
    
    <span class="c1"># Condition check</span>
    <span class="n">C2norm</span> <span class="o">=</span> <span class="n">C2</span><span class="o">*</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">s</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
    <span class="k">if</span> <span class="n">sy</span> <span class="o">&lt;=</span> <span class="n">C2norm</span> <span class="ow">or</span> <span class="n">d2</span> <span class="o">&lt;=</span> <span class="mf">1E-8</span><span class="p">:</span>
        <span class="n">skip</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">skip</span> <span class="o">=</span> <span class="kc">False</span>
    
    <span class="c1"># Add your solution here</span>
        
    <span class="k">return</span> <span class="n">dB</span> <span class="c1">#return the update to the Hessian approximation</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">line_search</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">grad</span><span class="p">,</span> <span class="n">calc_f</span><span class="p">,</span> <span class="n">pk</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">alpha_max</span><span class="p">,</span> <span class="n">eta_ls</span><span class="p">,</span> <span class="n">rho_ls</span><span class="p">,</span> <span class="n">verbose</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Function that implements the line search globalization strategy</span>
<span class="sd">    </span>
<span class="sd">    Inputs:</span>
<span class="sd">    x : decision variables</span>
<span class="sd">    f : objective values</span>
<span class="sd">    grad : gradients</span>
<span class="sd">    calc_f : function f(x) to minimize [scalar]</span>
<span class="sd">    pk : step</span>
<span class="sd">    k - Iteration number</span>
<span class="sd">    alpha_max : initial step length scaling for line search and/or steepest-descent</span>
<span class="sd">    eta_ls : parameter for Goldstein-Armijo conditions (line search only)</span>
<span class="sd">    rho_ls : parameter to shrink (backstep) line search</span>
<span class="sd">    verbose : toggles verbose output (True or False)</span>
<span class="sd">    </span>
<span class="sd">    Outputs:</span>
<span class="sd">    update : update to p</span>
<span class="sd">    alphak : update to alpha</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="c1"># Flag - continue line search?</span>
    <span class="n">ls</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="c1">## Initialize alpha</span>
    <span class="n">alphak</span> <span class="o">=</span> <span class="n">alpha_max</span>

    <span class="k">if</span><span class="p">(</span><span class="n">verbose</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2"> LINE SEARCH&quot;</span><span class="p">)</span>

    <span class="k">while</span> <span class="n">ls</span><span class="p">:</span>

        <span class="c1"># Calculate test point (if step accepted)</span>
        <span class="n">xtest</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="n">alphak</span><span class="o">*</span><span class="n">pk</span>

        <span class="c1"># Evaluate f(x) at test point. This is used for Armijo and Goldstein conditions</span>
        <span class="n">ftest</span> <span class="o">=</span> <span class="n">calc_f</span><span class="p">(</span><span class="n">xtest</span><span class="p">)</span>
        
        <span class="c1"># Add your solution here</span>

    <span class="c1"># Now the line search is complete, apply final value of alphak</span>
    <span class="n">update</span> <span class="o">=</span> <span class="n">alphak</span><span class="o">*</span><span class="n">pk</span>
    
    <span class="k">return</span> <span class="n">update</span><span class="p">,</span> <span class="n">alphak</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">trust_region</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">grad</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">delta</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">pk</span><span class="p">,</span> <span class="n">delta_0_tr</span><span class="p">,</span> <span class="n">verbose</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; </span>
<span class="sd">    Function that implements the trust region globalization strategy</span>
<span class="sd">    </span>
<span class="sd">    Inputs:</span>
<span class="sd">    x : decision variables</span>
<span class="sd">    grad : gradients</span>
<span class="sd">    B : Hessian approximation</span>
<span class="sd">    delta : trust region size</span>
<span class="sd">    k : Iteration number</span>
<span class="sd">    pk : step</span>
<span class="sd">    delta_0_tr : initial trust region size</span>
<span class="sd">    verbose : toggles verbose output (True or False)</span>
<span class="sd">    </span>
<span class="sd">    Outputs:</span>
<span class="sd">    update : update to p</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="c1">### Initialize trust region radius</span>
    <span class="k">if</span><span class="p">(</span><span class="n">k</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
        <span class="n">delta</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">delta_0_tr</span><span class="p">)</span>

    <span class="n">grad_zero</span> <span class="o">=</span> <span class="p">(</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">grad</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">&lt;</span> <span class="mf">1E-14</span><span class="p">)</span>

    <span class="c1">### Powell dogleg step</span>

    <span class="c1"># Calculate Cauchy step (pC)</span>
    <span class="n">denom</span> <span class="o">=</span> <span class="n">grad</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">B</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">grad</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span>
    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;TR: Cauchy step. grad.T*B*grad = &quot;</span><span class="p">,</span><span class="n">denom</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">denom</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="c1"># Term in ( ) is a scalar</span>
        <span class="n">pC</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">grad</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">grad</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">/</span><span class="n">denom</span><span class="p">)</span><span class="o">*</span><span class="n">grad</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
    <span class="k">elif</span> <span class="n">grad_zero</span><span class="p">:</span>
        <span class="n">pC</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">pC</span> <span class="o">=</span> <span class="o">-</span> <span class="n">delta</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">grad</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">*</span><span class="n">grad</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>

    <span class="c1"># Use Newton step (calculate above)</span>
    <span class="n">pN</span> <span class="o">=</span> <span class="n">pk</span>

    <span class="c1"># Determine step</span>
    <span class="k">if</span> <span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">pN</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">delta</span><span class="p">[</span><span class="n">k</span><span class="p">]:</span>
        <span class="c1"># Take Newton step. pN is inside the trust region.</span>
        <span class="n">update</span> <span class="o">=</span> <span class="n">pN</span>
        
    <span class="c1"># Add your solution here</span>
    
    <span class="k">return</span> <span class="n">update</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="feature-status">
<h3>Feature Status<a class="headerlink" href="#feature-status" title="Link to this heading">#</a></h3>
<p>For each feature, please indicate the status upon submission.</p>
<section id="sr1">
<h4>SR1<a class="headerlink" href="#sr1" title="Link to this heading">#</a></h4>
<p><em>Status</em>: please choose from âimplemented and testedâ, âimplemented but testing incompleteâ, âimplementation incompleteâ, âdid not attempt implementationâ</p>
<p><em>Details:</em> Please describe in a few sentences or bullet points the outstanding tasks.</p>
</section>
<section id="bfgs">
<h4>BFGS<a class="headerlink" href="#bfgs" title="Link to this heading">#</a></h4>
<p><em>Status</em>: please choose from âimplemented and testedâ, âimplemented but testing incompleteâ, âimplementation incompleteâ, âdid not attempt implementationâ</p>
<p><em>Details:</em> Please describe in a few sentences or bullet points the outstanding tasks.</p>
</section>
<section id="line-search">
<h4>Line Search<a class="headerlink" href="#line-search" title="Link to this heading">#</a></h4>
<p><em>Status</em>: please choose from âimplemented and testedâ, âimplemented but testing incompleteâ, âimplementation incompleteâ, âdid not attempt implementationâ</p>
<p><em>Details:</em> Please describe in a few sentences or bullet points the outstanding tasks.</p>
</section>
<section id="trust-region">
<h4>Trust Region<a class="headerlink" href="#trust-region" title="Link to this heading">#</a></h4>
<p><em>Status</em>: please choose from âimplemented and testedâ, âimplemented but testing incompleteâ, âimplementation incompleteâ, âdid not attempt implementationâ</p>
<p><em>Details:</em> Please describe in a few sentences or bullet points the outstanding tasks.</p>
</section>
</section>
</section>
<section id="benchmark-tests">
<h2>Benchmark Tests<a class="headerlink" href="#benchmark-tests" title="Link to this heading">#</a></h2>
<p>In the remainder of the assignment, we will compare using several variants of Newton-type methods in different test problems taken from in class examples. For each problem at a given starting point, we will consider ten algorithm cases:</p>
<ol class="arabic simple">
<li><p>Newton method with <strong>exact Hessian</strong> and no globalization strategy</p></li>
<li><p>Newton method with exact Hessian and line search</p></li>
<li><p>Newton method with exact Hessian and Powell dogleg trust region</p></li>
<li><p>Quasi-Newton method with <strong>SR1 Hessian approximation</strong> and no globalization strategy</p></li>
<li><p>Quasi-Newton method with SR1 Hessian approximation and line search</p></li>
<li><p>Quasi-Newton method with SR1 Hessian approximation and Powell dogleg trust region</p></li>
<li><p>Quasi-Newton method with <strong>BFGS Hessian approximation</strong> and no globalization strategy</p></li>
<li><p>Quasi-Newton method with BFGS Hessian approximation and line search</p></li>
<li><p>Quasi-Newton method with BFGS Hessian approximation and Powell dogleg trust region</p></li>
<li><p><strong>Steepest descent</strong> with line search</p></li>
</ol>
<p>We will then assess each candidate solution by the eigenvalues of the true Hessian. The norm of the gradient is already displayed.</p>
<p>All of this analysis has been automated in a function below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">check_sln</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">calc_hes</span><span class="p">):</span>
    <span class="n">Hval</span> <span class="o">=</span> <span class="n">calc_hes</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">l</span><span class="p">,</span> <span class="n">v</span> <span class="o">=</span> <span class="n">linalg</span><span class="o">.</span><span class="n">eig</span><span class="p">(</span><span class="n">Hval</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Eigenvalues of Hessian at x* = &quot;</span><span class="p">,</span><span class="n">l</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">benchmark</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span><span class="n">calc_f</span><span class="p">,</span><span class="n">calc_grad</span><span class="p">,</span><span class="n">calc_hes</span><span class="p">,</span><span class="n">verbose</span><span class="p">,</span><span class="n">cases</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">)):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Test 10 algorithm cases for a single starting point</span>
<span class="sd">    </span>
<span class="sd">    Arguments:</span>
<span class="sd">        x0 - starting point</span>
<span class="sd">        calc_f - function to evaluate objective</span>
<span class="sd">        calc_grad - function to evaluate gradient</span>
<span class="sd">        calc_hes - function to evaluate Hessian</span>
<span class="sd">        verbose - toggles verbose output (True or False)</span>
<span class="sd">        cases - list of cases to consider. Especially helpful for debugging.</span>
<span class="sd">            For example, setting cases=[1, 2] runs only case 2 and 3 (recall, Python starting counting at 0)</span>
<span class="sd">    &#39;&#39;&#39;</span>
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">cases</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;***Case 1: Newton method with exact Hessian and no globalization strategy***&quot;</span><span class="p">)</span>
            <span class="n">x1</span><span class="p">,</span><span class="n">f</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">B</span> <span class="o">=</span> <span class="n">unconstrained_newton</span><span class="p">(</span><span class="n">calc_f</span><span class="p">,</span><span class="n">calc_grad</span><span class="p">,</span><span class="n">calc_hes</span><span class="p">,</span><span class="n">x0</span><span class="p">,</span><span class="n">verbose</span><span class="p">,</span>
                                            <span class="n">algorithm</span><span class="o">=</span><span class="s2">&quot;newton&quot;</span><span class="p">,</span><span class="n">globalization</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">)</span>
            <span class="n">check_sln</span><span class="p">(</span><span class="n">x1</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">calc_hes</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
    
        <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;***Case 2: Newton method with exact Hessian and line search***&quot;</span><span class="p">)</span>
            <span class="n">x2</span><span class="p">,</span><span class="n">f</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">B</span> <span class="o">=</span> <span class="n">unconstrained_newton</span><span class="p">(</span><span class="n">calc_f</span><span class="p">,</span><span class="n">calc_grad</span><span class="p">,</span><span class="n">calc_hes</span><span class="p">,</span><span class="n">x0</span><span class="p">,</span><span class="n">verbose</span><span class="p">,</span>
                                            <span class="n">algorithm</span><span class="o">=</span><span class="s2">&quot;newton&quot;</span><span class="p">,</span><span class="n">globalization</span><span class="o">=</span><span class="s2">&quot;line-search&quot;</span><span class="p">)</span>
            <span class="n">check_sln</span><span class="p">(</span><span class="n">x2</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">calc_hes</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            
        <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;***Case 3: Newton method with exact Hessian and trust region***&quot;</span><span class="p">)</span>
            <span class="n">x3</span><span class="p">,</span><span class="n">f</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">B</span> <span class="o">=</span> <span class="n">unconstrained_newton</span><span class="p">(</span><span class="n">calc_f</span><span class="p">,</span><span class="n">calc_grad</span><span class="p">,</span><span class="n">calc_hes</span><span class="p">,</span><span class="n">x0</span><span class="p">,</span><span class="n">verbose</span><span class="p">,</span>
                                            <span class="n">algorithm</span><span class="o">=</span><span class="s2">&quot;newton&quot;</span><span class="p">,</span><span class="n">globalization</span><span class="o">=</span><span class="s2">&quot;trust-region&quot;</span><span class="p">)</span>
            <span class="n">check_sln</span><span class="p">(</span><span class="n">x3</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">calc_hes</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            
        <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;***Case 4: Quasi-Newton method with SR1 Hessian approximation and no globalization strategy***&quot;</span><span class="p">)</span>
            <span class="n">x4</span><span class="p">,</span><span class="n">f</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">B</span> <span class="o">=</span> <span class="n">unconstrained_newton</span><span class="p">(</span><span class="n">calc_f</span><span class="p">,</span><span class="n">calc_grad</span><span class="p">,</span><span class="n">calc_hes</span><span class="p">,</span><span class="n">x0</span><span class="p">,</span><span class="n">verbose</span><span class="p">,</span>
                                            <span class="n">algorithm</span><span class="o">=</span><span class="s2">&quot;sr1&quot;</span><span class="p">,</span><span class="n">globalization</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">)</span>
            <span class="n">check_sln</span><span class="p">(</span><span class="n">x4</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">calc_hes</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            
        <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;***Case 5: Quasi-Newton method with SR1 Hessian approximation and line search***&quot;</span><span class="p">)</span>
            <span class="n">x5</span><span class="p">,</span><span class="n">f</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">B</span> <span class="o">=</span> <span class="n">unconstrained_newton</span><span class="p">(</span><span class="n">calc_f</span><span class="p">,</span><span class="n">calc_grad</span><span class="p">,</span><span class="n">calc_hes</span><span class="p">,</span><span class="n">x0</span><span class="p">,</span><span class="n">verbose</span><span class="p">,</span>
                                            <span class="n">algorithm</span><span class="o">=</span><span class="s2">&quot;sr1&quot;</span><span class="p">,</span><span class="n">globalization</span><span class="o">=</span><span class="s2">&quot;line-search&quot;</span><span class="p">)</span>
            <span class="n">check_sln</span><span class="p">(</span><span class="n">x5</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">calc_hes</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            
        <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">5</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;***Case 6: Quasi-Newton method with SR1 Hessian approximation and trust region***&quot;</span><span class="p">)</span>
            <span class="n">x6</span><span class="p">,</span><span class="n">f</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">B</span> <span class="o">=</span> <span class="n">unconstrained_newton</span><span class="p">(</span><span class="n">calc_f</span><span class="p">,</span><span class="n">calc_grad</span><span class="p">,</span><span class="n">calc_hes</span><span class="p">,</span><span class="n">x0</span><span class="p">,</span><span class="n">verbose</span><span class="p">,</span>
                                            <span class="n">algorithm</span><span class="o">=</span><span class="s2">&quot;sr1&quot;</span><span class="p">,</span><span class="n">globalization</span><span class="o">=</span><span class="s2">&quot;trust-region&quot;</span><span class="p">)</span>
            <span class="n">check_sln</span><span class="p">(</span><span class="n">x6</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">calc_hes</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">6</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;***Case 7: Quasi-Newton method with BFGS Hessian approximation and no globalization strategy***&quot;</span><span class="p">)</span>
            <span class="n">x7</span><span class="p">,</span><span class="n">f</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">B</span> <span class="o">=</span> <span class="n">unconstrained_newton</span><span class="p">(</span><span class="n">calc_f</span><span class="p">,</span><span class="n">calc_grad</span><span class="p">,</span><span class="n">calc_hes</span><span class="p">,</span><span class="n">x0</span><span class="p">,</span><span class="n">verbose</span><span class="p">,</span>
                                            <span class="n">algorithm</span><span class="o">=</span><span class="s2">&quot;bfgs&quot;</span><span class="p">,</span><span class="n">globalization</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">)</span>
            <span class="n">check_sln</span><span class="p">(</span><span class="n">x7</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">calc_hes</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            
        <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">7</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;***Case 8: Quasi-Newton method with BFGS Hessian approximation and line search***&quot;</span><span class="p">)</span>
            <span class="n">x8</span><span class="p">,</span><span class="n">f</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">B</span> <span class="o">=</span> <span class="n">unconstrained_newton</span><span class="p">(</span><span class="n">calc_f</span><span class="p">,</span><span class="n">calc_grad</span><span class="p">,</span><span class="n">calc_hes</span><span class="p">,</span><span class="n">x0</span><span class="p">,</span><span class="n">verbose</span><span class="p">,</span>
                                            <span class="n">algorithm</span><span class="o">=</span><span class="s2">&quot;bfgs&quot;</span><span class="p">,</span><span class="n">globalization</span><span class="o">=</span><span class="s2">&quot;line-search&quot;</span><span class="p">)</span>
            <span class="n">check_sln</span><span class="p">(</span><span class="n">x8</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">calc_hes</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">8</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;***Case 9: Quasi-Newton method with BFGS Hessian approximation and trust region***&quot;</span><span class="p">)</span>
            <span class="n">x9</span><span class="p">,</span><span class="n">f</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">B</span> <span class="o">=</span> <span class="n">unconstrained_newton</span><span class="p">(</span><span class="n">calc_f</span><span class="p">,</span><span class="n">calc_grad</span><span class="p">,</span><span class="n">calc_hes</span><span class="p">,</span><span class="n">x0</span><span class="p">,</span><span class="n">verbose</span><span class="p">,</span>
                                            <span class="n">algorithm</span><span class="o">=</span><span class="s2">&quot;bfgs&quot;</span><span class="p">,</span><span class="n">globalization</span><span class="o">=</span><span class="s2">&quot;trust-region&quot;</span><span class="p">)</span>
            <span class="n">check_sln</span><span class="p">(</span><span class="n">x9</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">calc_hes</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">9</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;***Case 10: Steepest Descent and line search***&quot;</span><span class="p">)</span>
            <span class="n">x10</span><span class="p">,</span><span class="n">f</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">B</span> <span class="o">=</span> <span class="n">unconstrained_newton</span><span class="p">(</span><span class="n">calc_f</span><span class="p">,</span><span class="n">calc_grad</span><span class="p">,</span><span class="n">calc_hes</span><span class="p">,</span><span class="n">x0</span><span class="p">,</span><span class="n">verbose</span><span class="p">,</span>
                                             <span class="n">algorithm</span><span class="o">=</span><span class="s2">&quot;steepest-descent&quot;</span><span class="p">,</span><span class="n">globalization</span><span class="o">=</span><span class="s2">&quot;line-search&quot;</span><span class="p">)</span>
            <span class="n">check_sln</span><span class="p">(</span><span class="n">x10</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">calc_hes</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<section id="quadratic-test-problem">
<h3>Quadratic Test Problem<a class="headerlink" href="#quadratic-test-problem" title="Link to this heading">#</a></h3>
<p>Start debugging your function with the following problem:</p>
<div class="math notranslate nohighlight">
\[\min_x ~~ x_1^2 + (x_2 -1)^2\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">my_f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>

<span class="k">def</span><span class="w"> </span><span class="nf">my_grad</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="p">])</span>

<span class="k">def</span><span class="w"> </span><span class="nf">my_hes</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<section id="benchmark-cases">
<h4>Benchmark Cases<a class="headerlink" href="#benchmark-cases" title="Link to this heading">#</a></h4>
<p>The following code below runs cases 1 through 10. You can specify only a subset using the <code class="docutils literal notranslate"><span class="pre">cases</span></code> keyword.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">3.0</span><span class="p">,</span><span class="mf">2.0</span><span class="p">])</span>
<span class="n">benchmark</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span><span class="n">my_f</span><span class="p">,</span><span class="n">my_grad</span><span class="p">,</span><span class="n">my_hes</span><span class="p">,</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>***Case 1: Newton method with exact Hessian and no globalization strategy***
Iter. 	f(x) 		||grad(x)|| 	||p|| 		min(eig(B)) 	alpha 		delta 		step
0   	 1.0000e+01 	6.3246e+00 	3.1623e+00 	 2.0000e+00 	 ------- 	 ------- 	 -----
1   	 0.0000e+00 	0.0000e+00 	0.0000e+00 	 2.0000e+00 	 ------- 	 ------- 	 -----
x* =  [0. 1.]
Eigenvalues of Hessian at x* =  [2.+0.j 2.+0.j]


***Case 2: Newton method with exact Hessian and line search***
Iter. 	f(x) 		||grad(x)|| 	||p|| 		min(eig(B)) 	alpha 		delta 		step
0   	 1.0000e+01 	6.3246e+00 	3.1623e+00 	 2.0000e+00 	 1.00e+00 	 ------- 	 -----
1   	 0.0000e+00 	0.0000e+00 	0.0000e+00 	 2.0000e+00 	 1.00e+00 	 ------- 	 -----
x* =  [0. 1.]
Eigenvalues of Hessian at x* =  [2.+0.j 2.+0.j]


***Case 3: Newton method with exact Hessian and trust region***
Iter. 	f(x) 		||grad(x)|| 	||p|| 		min(eig(B)) 	alpha 		delta 		step
0   	 1.0000e+01 	6.3246e+00 	2.0000e+00 	 2.0000e+00 	 ------- 	 2.00e+00 	 accept
1   	 1.3509e+00 	2.3246e+00 	1.1623e+00 	 2.0000e+00 	 ------- 	 4.00e+00 	 accept
2   	 0.0000e+00 	0.0000e+00 	0.0000e+00 	 2.0000e+00 	 ------- 	 4.00e+00 	 accept
x* =  [0. 1.]
Eigenvalues of Hessian at x* =  [2.+0.j 2.+0.j]


***Case 4: Quasi-Newton method with SR1 Hessian approximation and no globalization strategy***
Iter. 	f(x) 		||grad(x)|| 	||p|| 		min(eig(B)) 	alpha 		delta 		step
0   	 1.0000e+01 	6.3246e+00 	6.3246e+00 	 1.0000e+00 	 ------- 	 ------- 	 -----
1   	 1.0000e+01 	6.3246e+00 	3.1623e+00 	 1.0000e+00 	 ------- 	 ------- 	 -----
2   	 1.9722e-31 	8.8818e-16 	5.0634e-16 	 1.0000e+00 	 ------- 	 ------- 	 -----
x* =  [4.4408921e-17 1.0000000e+00]
Eigenvalues of Hessian at x* =  [2.+0.j 2.+0.j]


***Case 5: Quasi-Newton method with SR1 Hessian approximation and line search***
Iter. 	f(x) 		||grad(x)|| 	||p|| 		min(eig(B)) 	alpha 		delta 		step
0   	 1.0000e+01 	6.3246e+00 	4.6106e+00 	 1.0000e+00 	 7.29e-01 	 ------- 	 -----
1   	 2.0976e+00 	2.8966e+00 	1.4483e+00 	 1.0000e+00 	 1.00e+00 	 ------- 	 -----
2   	 0.0000e+00 	0.0000e+00 	0.0000e+00 	 1.0000e+00 	 1.00e+00 	 ------- 	 -----
x* =  [0. 1.]
Eigenvalues of Hessian at x* =  [2.+0.j 2.+0.j]


***Case 6: Quasi-Newton method with SR1 Hessian approximation and trust region***
Iter. 	f(x) 		||grad(x)|| 	||p|| 		min(eig(B)) 	alpha 		delta 		step
0   	 1.0000e+01 	6.3246e+00 	2.0000e+00 	 1.0000e+00 	 ------- 	 2.00e+00 	 accept
1   	 1.3509e+00 	2.3246e+00 	1.1623e+00 	 1.0000e+00 	 ------- 	 4.00e+00 	 accept
2   	 9.8608e-32 	6.2804e-16 	5.7902e-16 	 1.0000e+00 	 ------- 	 4.00e+00 	 accept
x* =  [-8.8817842e-17  1.0000000e+00]
Eigenvalues of Hessian at x* =  [2.+0.j 2.+0.j]


***Case 7: Quasi-Newton method with BFGS Hessian approximation and no globalization strategy***
Iter. 	f(x) 		||grad(x)|| 	||p|| 		min(eig(B)) 	alpha 		delta 		step
0   	 1.0000e+01 	6.3246e+00 	6.3246e+00 	 1.0000e+00 	 ------- 	 ------- 	 -----
1   	 1.0000e+01 	6.3246e+00 	3.1623e+00 	 1.0000e+00 	 ------- 	 ------- 	 -----
2   	 1.9722e-31 	8.8818e-16 	5.0634e-16 	 1.0000e+00 	 ------- 	 ------- 	 -----
x* =  [4.4408921e-17 1.0000000e+00]
Eigenvalues of Hessian at x* =  [2.+0.j 2.+0.j]


***Case 8: Quasi-Newton method with BFGS Hessian approximation and line search***
Iter. 	f(x) 		||grad(x)|| 	||p|| 		min(eig(B)) 	alpha 		delta 		step
0   	 1.0000e+01 	6.3246e+00 	4.6106e+00 	 1.0000e+00 	 7.29e-01 	 ------- 	 -----
1   	 2.0976e+00 	2.8966e+00 	1.4483e+00 	 1.0000e+00 	 1.00e+00 	 ------- 	 -----
2   	 0.0000e+00 	0.0000e+00 	0.0000e+00 	 1.0000e+00 	 1.00e+00 	 ------- 	 -----
x* =  [0. 1.]
Eigenvalues of Hessian at x* =  [2.+0.j 2.+0.j]


***Case 9: Quasi-Newton method with BFGS Hessian approximation and trust region***
Iter. 	f(x) 		||grad(x)|| 	||p|| 		min(eig(B)) 	alpha 		delta 		step
0   	 1.0000e+01 	6.3246e+00 	2.0000e+00 	 1.0000e+00 	 ------- 	 2.00e+00 	 accept
1   	 1.3509e+00 	2.3246e+00 	1.1623e+00 	 1.0000e+00 	 ------- 	 4.00e+00 	 accept
2   	 9.8608e-32 	6.2804e-16 	5.7902e-16 	 1.0000e+00 	 ------- 	 4.00e+00 	 accept
x* =  [-8.8817842e-17  1.0000000e+00]
Eigenvalues of Hessian at x* =  [2.+0.j 2.+0.j]


***Case 10: Steepest Descent and line search***
Iter. 	f(x) 		||grad(x)|| 	||p|| 		min(eig(B)) 	alpha 		delta 		step
0   	 1.0000e+01 	6.3246e+00 	4.6106e+00 	 1.0000e+00 	 7.29e-01 	 ------- 	 -----
1   	 2.0976e+00 	2.8966e+00 	2.1117e+00 	 1.0000e+00 	 7.29e-01 	 ------- 	 -----
2   	 4.4001e-01 	1.3267e+00 	9.6714e-01 	 1.0000e+00 	 7.29e-01 	 ------- 	 -----
3   	 9.2298e-02 	6.0761e-01 	4.4295e-01 	 1.0000e+00 	 7.29e-01 	 ------- 	 -----
4   	 1.9361e-02 	2.7829e-01 	2.0287e-01 	 1.0000e+00 	 7.29e-01 	 ------- 	 -----
5   	 4.0612e-03 	1.2746e-01 	9.2915e-02 	 1.0000e+00 	 7.29e-01 	 ------- 	 -----
6   	 8.5189e-04 	5.8374e-02 	4.2555e-02 	 1.0000e+00 	 7.29e-01 	 ------- 	 -----
7   	 1.7870e-04 	2.6736e-02 	1.9490e-02 	 1.0000e+00 	 7.29e-01 	 ------- 	 -----
8   	 3.7484e-05 	1.2245e-02 	8.9265e-03 	 1.0000e+00 	 7.29e-01 	 ------- 	 -----
9   	 7.8628e-06 	5.6081e-03 	4.0883e-03 	 1.0000e+00 	 7.29e-01 	 ------- 	 -----
10   	 1.6493e-06 	2.5685e-03 	1.8725e-03 	 1.0000e+00 	 7.29e-01 	 ------- 	 -----
11   	 3.4597e-07 	1.1764e-03 	8.5759e-04 	 1.0000e+00 	 7.29e-01 	 ------- 	 -----
12   	 7.2572e-08 	5.3879e-04 	3.9277e-04 	 1.0000e+00 	 7.29e-01 	 ------- 	 -----
13   	 1.5223e-08 	2.4676e-04 	1.7989e-04 	 1.0000e+00 	 7.29e-01 	 ------- 	 -----
14   	 3.1933e-09 	1.1302e-04 	8.2390e-05 	 1.0000e+00 	 7.29e-01 	 ------- 	 -----
15   	 6.6983e-10 	5.1762e-05 	3.7735e-05 	 1.0000e+00 	 7.29e-01 	 ------- 	 -----
16   	 1.4051e-10 	2.3707e-05 	1.7282e-05 	 1.0000e+00 	 7.29e-01 	 ------- 	 -----
17   	 2.9473e-11 	1.0858e-05 	7.9154e-06 	 1.0000e+00 	 7.29e-01 	 ------- 	 -----
18   	 6.1824e-12 	4.9729e-06 	3.6252e-06 	 1.0000e+00 	 7.29e-01 	 ------- 	 -----
19   	 1.2968e-12 	2.2776e-06 	1.6604e-06 	 1.0000e+00 	 7.29e-01 	 ------- 	 -----
20   	 2.7203e-13 	1.0431e-06 	7.6044e-07 	 1.0000e+00 	 7.29e-01 	 ------- 	 -----
x* =  [2.26618986e-07 9.99999924e-01]
Eigenvalues of Hessian at x* =  [2.+0.j 2.+0.j]
</pre></div>
</div>
</div>
</div>
</section>
<section id="discussion-and-analysis">
<h4>Discussion and Analysis<a class="headerlink" href="#discussion-and-analysis" title="Link to this heading">#</a></h4>
<p>Classify the solutions.</p>
<p><strong>Answer:</strong></p>
<p>Should we expect the SR1, BFGS, and steepest descent (all with line search) to always have the same results for the first iteration? Explain in a few sentences.</p>
<p><strong>Answer:</strong></p>
<p>For this problem, should we always expect all of the cases to converge to the same solution (regardless of starting point)? Explain in a few sentences.</p>
<p><strong>Answer:</strong></p>
</section>
</section>
<section id="one-dimensional-example">
<h3>One-Dimensional Example<a class="headerlink" href="#one-dimensional-example" title="Link to this heading">#</a></h3>
<p>Consider a scalar function <span class="math notranslate nohighlight">\(f(x): \mathbb{R} \rightarrow \mathbb{R}\)</span>. Recall</p>
<div class="math notranslate nohighlight">
\[f(x) = 0.5 (x-1)^4 + (x+1)^3 - 10 x^2 + 5 x\]</div>
<div class="math notranslate nohighlight">
\[f'(x) = 6 - 8 x - 3 x^2 + 2 x^3\]</div>
<div class="math notranslate nohighlight">
\[f''(x) = -8 - 6 x + 6 x^2 \]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Define f(x)</span>
<span class="n">f_</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">10</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">5</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="c1">## Define f&#39;(x)</span>
<span class="n">df_</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="p">(</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">8</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="c1">## Define f&#39;&#39;(x)</span>
<span class="n">ddf_</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="p">(</span><span class="o">-</span><span class="mi">8</span> <span class="o">-</span> <span class="mi">6</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">6</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<section id="benchmark-cases-with-x-0-3">
<h4>Benchmark Cases with <span class="math notranslate nohighlight">\(x_0 = -3\)</span><a class="headerlink" href="#benchmark-cases-with-x-0-3" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mf">3.0</span><span class="p">)</span>
<span class="n">benchmark</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span><span class="n">f_</span><span class="p">,</span><span class="n">df_</span><span class="p">,</span><span class="n">ddf_</span><span class="p">,</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>***Case 1: Newton method with exact Hessian and no globalization strategy***
Iter. 	f(x) 		||grad(x)|| 	||p|| 		min(eig(B)) 	alpha 		delta 		step
0   	 1.5000e+01 	5.1000e+01 	7.9688e-01 	 6.4000e+01 	 ------- 	 ------- 	 -----
1   	-8.6609e+00 	1.2323e+01 	3.5884e-01 	 3.4341e+01 	 ------- 	 ------- 	 -----
2   	-1.1113e+01 	1.9961e+00 	8.5033e-02 	 2.3474e+01 	 ------- 	 ------- 	 -----
3   	-1.1201e+01 	1.0047e-01 	4.7561e-03 	 2.1125e+01 	 ------- 	 ------- 	 -----
4   	-1.1201e+01 	3.0641e-04 	1.4594e-05 	 2.0996e+01 	 ------- 	 ------- 	 -----
5   	-1.1201e+01 	2.8809e-09 	1.3721e-10 	 2.0996e+01 	 ------- 	 ------- 	 -----
x* =  [-1.75447804]
Eigenvalues of Hessian at x* =  [20.99602743+0.j]


***Case 2: Newton method with exact Hessian and line search***
Iter. 	f(x) 		||grad(x)|| 	||p|| 		min(eig(B)) 	alpha 		delta 		step
0   	 1.5000e+01 	5.1000e+01 	7.9688e-01 	 6.4000e+01 	 1.00e+00 	 ------- 	 -----
1   	-8.6609e+00 	1.2323e+01 	3.5884e-01 	 3.4341e+01 	 1.00e+00 	 ------- 	 -----
2   	-1.1113e+01 	1.9961e+00 	8.5033e-02 	 2.3474e+01 	 1.00e+00 	 ------- 	 -----
3   	-1.1201e+01 	1.0047e-01 	4.7561e-03 	 2.1125e+01 	 1.00e+00 	 ------- 	 -----
4   	-1.1201e+01 	3.0641e-04 	1.4594e-05 	 2.0996e+01 	 1.00e+00 	 ------- 	 -----
5   	-1.1201e+01 	2.8809e-09 	1.3721e-10 	 2.0996e+01 	 1.00e+00 	 ------- 	 -----
x* =  [-1.75447804]
Eigenvalues of Hessian at x* =  [20.99602743+0.j]


***Case 3: Newton method with exact Hessian and trust region***
Iter. 	f(x) 		||grad(x)|| 	||p|| 		min(eig(B)) 	alpha 		delta 		step
0   	 1.5000e+01 	5.1000e+01 	7.9688e-01 	 6.4000e+01 	 ------- 	 2.00e+00 	 accept
1   	-8.6609e+00 	1.2323e+01 	3.5884e-01 	 3.4341e+01 	 ------- 	 2.00e+00 	 accept
2   	-1.1113e+01 	1.9961e+00 	8.5033e-02 	 2.3474e+01 	 ------- 	 2.00e+00 	 accept
3   	-1.1201e+01 	1.0047e-01 	4.7561e-03 	 2.1125e+01 	 ------- 	 2.00e+00 	 accept
4   	-1.1201e+01 	3.0641e-04 	1.4594e-05 	 2.0996e+01 	 ------- 	 2.00e+00 	 accept
5   	-1.1201e+01 	2.8809e-09 	1.3721e-10 	 2.0996e+01 	 ------- 	 2.00e+00 	 accept
x* =  [-1.75447804]
Eigenvalues of Hessian at x* =  [20.99602743+0.j]


***Case 4: Quasi-Newton method with SR1 Hessian approximation and no globalization strategy***
Iter. 	f(x) 		||grad(x)|| 	||p|| 		min(eig(B)) 	alpha 		delta 		step
0   	 1.5000e+01 	5.1000e+01 	5.1000e+01 	 1.0000e+00 	 ------- 	 ------- 	 -----
1   	 2.5347e+06 	2.1389e+05 	5.0988e+01 	 4.1950e+03 	 ------- 	 ------- 	 -----
2   	 1.4385e+01 	5.0225e+01 	1.1970e-02 	 4.1960e+03 	 ------- 	 ------- 	 -----
3   	 1.3788e+01 	4.9468e+01 	7.8223e-01 	 6.3240e+01 	 ------- 	 ------- 	 -----
4   	-8.7761e+00 	1.1999e+01 	2.5050e-01 	 4.7900e+01 	 ------- 	 ------- 	 -----
5   	-1.0797e+01 	4.4562e+00 	1.4799e-01 	 3.0111e+01 	 ------- 	 ------- 	 -----
6   	-1.1184e+01 	8.7657e-01 	3.6239e-02 	 2.4188e+01 	 ------- 	 ------- 	 -----
7   	-1.1201e+01 	9.3432e-02 	4.3236e-03 	 2.1610e+01 	 ------- 	 ------- 	 -----
8   	-1.1201e+01 	2.3882e-03 	1.1341e-04 	 2.1058e+01 	 ------- 	 ------- 	 -----
9   	-1.1201e+01 	6.8113e-06 	3.2439e-07 	 2.0998e+01 	 ------- 	 ------- 	 -----
x* =  [-1.75447804]
Eigenvalues of Hessian at x* =  [20.99602743+0.j]


***Case 5: Quasi-Newton method with SR1 Hessian approximation and line search***
Iter. 	f(x) 		||grad(x)|| 	||p|| 		min(eig(B)) 	alpha 		delta 		step
0   	 1.5000e+01 	5.1000e+01 	1.7512e+00 	 1.0000e+00 	 3.43e-02 	 ------- 	 -----
1   	-9.0674e+00 	7.4167e+00 	2.2233e-01 	 3.3359e+01 	 1.00e+00 	 ------- 	 -----
2   	-1.0458e+01 	4.9083e+00 	3.9155e-01 	 1.1282e+01 	 9.00e-01 	 ------- 	 -----
3   	-1.1073e+01 	2.4333e+00 	1.2978e-01 	 1.8750e+01 	 1.00e+00 	 ------- 	 -----
4   	-1.1197e+01 	4.4617e-01 	2.0109e-02 	 2.2188e+01 	 1.00e+00 	 ------- 	 -----
5   	-1.1201e+01 	3.0206e-02 	1.4602e-03 	 2.0686e+01 	 1.00e+00 	 ------- 	 -----
6   	-1.1201e+01 	4.2458e-04 	2.0241e-05 	 2.0977e+01 	 1.00e+00 	 ------- 	 -----
Line search failure. alpha =  0.43046721000000016
7   	-1.1201e+01 	3.9417e-07 	8.0888e-09 	 2.0977e+01 	 4.30e-01 	 ------- 	 -----
x* =  [-1.75447803]
Eigenvalues of Hessian at x* =  [20.99602714+0.j]


***Case 6: Quasi-Newton method with SR1 Hessian approximation and trust region***
Iter. 	f(x) 		||grad(x)|| 	||p|| 		min(eig(B)) 	alpha 		delta 		step
0   	 1.5000e+01 	5.1000e+01 	2.0000e+00 	 1.0000e+00 	 ------- 	 2.00e+00 	 accept
1   	-7.0000e+00 	9.0000e+00 	3.0000e-01 	 3.0000e+01 	 ------- 	 5.00e-01 	 accept
2   	-9.4350e+00 	6.9360e+00 	5.0000e-01 	 6.8800e+00 	 ------- 	 5.00e-01 	 accept
3   	-1.1179e+01 	9.8400e-01 	6.2121e-02 	 1.5840e+01 	 ------- 	 5.00e-01 	 accept
4   	-1.1199e+01 	3.4480e-01 	1.6119e-02 	 2.1390e+01 	 ------- 	 5.00e-01 	 accept
5   	-1.1201e+01 	1.0073e-02 	4.8506e-04 	 2.0766e+01 	 ------- 	 5.00e-01 	 accept
6   	-1.1201e+01 	1.0867e-04 	5.1775e-06 	 2.0990e+01 	 ------- 	 5.00e-01 	 accept
7   	-1.1201e+01 	3.3607e-08 	1.6011e-09 	 2.0990e+01 	 ------- 	 5.00e-01 	 accept
x* =  [-1.75447804]
Eigenvalues of Hessian at x* =  [20.99602743+0.j]


***Case 7: Quasi-Newton method with BFGS Hessian approximation and no globalization strategy***
Iter. 	f(x) 		||grad(x)|| 	||p|| 		min(eig(B)) 	alpha 		delta 		step
0   	 1.5000e+01 	5.1000e+01 	5.1000e+01 	 1.0000e+00 	 ------- 	 ------- 	 -----
1   	 2.5347e+06 	2.1389e+05 	5.0988e+01 	 4.1950e+03 	 ------- 	 ------- 	 -----
2   	 1.4385e+01 	5.0225e+01 	1.1970e-02 	 4.1960e+03 	 ------- 	 ------- 	 -----
3   	 1.3788e+01 	4.9468e+01 	7.8223e-01 	 6.3240e+01 	 ------- 	 ------- 	 -----
4   	-8.7761e+00 	1.1999e+01 	2.5050e-01 	 4.7900e+01 	 ------- 	 ------- 	 -----
5   	-1.0797e+01 	4.4562e+00 	1.4799e-01 	 3.0111e+01 	 ------- 	 ------- 	 -----
6   	-1.1184e+01 	8.7657e-01 	3.6239e-02 	 2.4188e+01 	 ------- 	 ------- 	 -----
7   	-1.1201e+01 	9.3432e-02 	4.3236e-03 	 2.1610e+01 	 ------- 	 ------- 	 -----
8   	-1.1201e+01 	2.3882e-03 	1.1341e-04 	 2.1058e+01 	 ------- 	 ------- 	 -----
9   	-1.1201e+01 	6.8113e-06 	3.2439e-07 	 2.0998e+01 	 ------- 	 ------- 	 -----
x* =  [-1.75447804]
Eigenvalues of Hessian at x* =  [20.99602743+0.j]


***Case 8: Quasi-Newton method with BFGS Hessian approximation and line search***
Iter. 	f(x) 		||grad(x)|| 	||p|| 		min(eig(B)) 	alpha 		delta 		step
0   	 1.5000e+01 	5.1000e+01 	1.7512e+00 	 1.0000e+00 	 3.43e-02 	 ------- 	 -----
1   	-9.0674e+00 	7.4167e+00 	2.2233e-01 	 3.3359e+01 	 1.00e+00 	 ------- 	 -----
2   	-1.0458e+01 	4.9083e+00 	3.9155e-01 	 1.1282e+01 	 9.00e-01 	 ------- 	 -----
3   	-1.1073e+01 	2.4333e+00 	1.2978e-01 	 1.8750e+01 	 1.00e+00 	 ------- 	 -----
4   	-1.1197e+01 	4.4617e-01 	2.0109e-02 	 2.2188e+01 	 1.00e+00 	 ------- 	 -----
5   	-1.1201e+01 	3.0206e-02 	1.4602e-03 	 2.0686e+01 	 1.00e+00 	 ------- 	 -----
6   	-1.1201e+01 	4.2458e-04 	2.0241e-05 	 2.0977e+01 	 1.00e+00 	 ------- 	 -----
Line search failure. alpha =  0.43046721000000016
7   	-1.1201e+01 	3.9417e-07 	8.0888e-09 	 2.0977e+01 	 4.30e-01 	 ------- 	 -----
x* =  [-1.75447803]
Eigenvalues of Hessian at x* =  [20.99602714+0.j]


***Case 9: Quasi-Newton method with BFGS Hessian approximation and trust region***
Iter. 	f(x) 		||grad(x)|| 	||p|| 		min(eig(B)) 	alpha 		delta 		step
0   	 1.5000e+01 	5.1000e+01 	2.0000e+00 	 1.0000e+00 	 ------- 	 2.00e+00 	 accept
1   	-7.0000e+00 	9.0000e+00 	3.0000e-01 	 3.0000e+01 	 ------- 	 5.00e-01 	 accept
2   	-9.4350e+00 	6.9360e+00 	5.0000e-01 	 6.8800e+00 	 ------- 	 5.00e-01 	 accept
3   	-1.1179e+01 	9.8400e-01 	6.2121e-02 	 1.5840e+01 	 ------- 	 5.00e-01 	 accept
4   	-1.1199e+01 	3.4480e-01 	1.6119e-02 	 2.1390e+01 	 ------- 	 5.00e-01 	 accept
5   	-1.1201e+01 	1.0073e-02 	4.8506e-04 	 2.0766e+01 	 ------- 	 5.00e-01 	 accept
6   	-1.1201e+01 	1.0867e-04 	5.1775e-06 	 2.0990e+01 	 ------- 	 5.00e-01 	 accept
7   	-1.1201e+01 	3.3607e-08 	1.6011e-09 	 2.0990e+01 	 ------- 	 5.00e-01 	 accept
x* =  [-1.75447804]
Eigenvalues of Hessian at x* =  [20.99602743+0.j]


***Case 10: Steepest Descent and line search***
Iter. 	f(x) 		||grad(x)|| 	||p|| 		min(eig(B)) 	alpha 		delta 		step
0   	 1.5000e+01 	5.1000e+01 	1.7512e+00 	 1.0000e+00 	 3.43e-02 	 ------- 	 -----
1   	-9.0674e+00 	7.4167e+00 	7.3037e-01 	 1.0000e+00 	 9.85e-02 	 ------- 	 -----
2   	-1.0619e+01 	5.4240e+00 	3.1540e-01 	 1.0000e+00 	 5.81e-02 	 ------- 	 -----
3   	-1.1118e+01 	1.7943e+00 	1.2881e-01 	 1.0000e+00 	 7.18e-02 	 ------- 	 -----
4   	-1.1186e+01 	8.2025e-01 	5.2997e-02 	 1.0000e+00 	 6.46e-02 	 ------- 	 -----
5   	-1.1199e+01 	3.0927e-01 	2.2202e-02 	 1.0000e+00 	 7.18e-02 	 ------- 	 -----
6   	-1.1201e+01 	1.5463e-01 	9.9909e-03 	 1.0000e+00 	 6.46e-02 	 ------- 	 -----
7   	-1.1201e+01 	5.5769e-02 	3.6033e-03 	 1.0000e+00 	 6.46e-02 	 ------- 	 -----
8   	-1.1201e+01 	1.9802e-02 	1.2794e-03 	 1.0000e+00 	 6.46e-02 	 ------- 	 -----
9   	-1.1201e+01 	7.0713e-03 	4.5688e-04 	 1.0000e+00 	 6.46e-02 	 ------- 	 -----
10   	-1.1201e+01 	2.5201e-03 	1.6282e-04 	 1.0000e+00 	 6.46e-02 	 ------- 	 -----
11   	-1.1201e+01 	8.9875e-04 	5.8069e-05 	 1.0000e+00 	 6.46e-02 	 ------- 	 -----
12   	-1.1201e+01 	3.2045e-04 	2.0704e-05 	 1.0000e+00 	 6.46e-02 	 ------- 	 -----
13   	-1.1201e+01 	1.1426e-04 	7.3828e-06 	 1.0000e+00 	 6.46e-02 	 ------- 	 -----
14   	-1.1201e+01 	4.0743e-05 	2.6324e-06 	 1.0000e+00 	 6.46e-02 	 ------- 	 -----
15   	-1.1201e+01 	1.4528e-05 	9.3866e-07 	 1.0000e+00 	 6.46e-02 	 ------- 	 -----
x* =  [-1.75447829]
Eigenvalues of Hessian at x* =  [20.9960341+0.j]
</pre></div>
</div>
</div>
</div>
</section>
<section id="discussion">
<h4>Discussion<a class="headerlink" href="#discussion" title="Link to this heading">#</a></h4>
<p>Did all of the cases converge to the nearby solution?</p>
<p><strong>Answer</strong></p>
</section>
</section>
<section id="benchmark-case-with-x-0-0">
<h3>Benchmark Case with <span class="math notranslate nohighlight">\(x_0 = 0\)</span><a class="headerlink" href="#benchmark-case-with-x-0-0" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">benchmark</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span><span class="n">f_</span><span class="p">,</span><span class="n">df_</span><span class="p">,</span><span class="n">ddf_</span><span class="p">,</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>***Case 1: Newton method with exact Hessian and no globalization strategy***
Iter. 	f(x) 		||grad(x)|| 	||p|| 		min(eig(B)) 	alpha 		delta 		step
0   	 1.5000e+00 	6.0000e+00 	7.5000e-01 	-8.0000e+00 	 ------- 	 ------- 	 -----
1   	 3.4863e+00 	8.4375e-01 	9.2466e-02 	-9.1250e+00 	 ------- 	 ------- 	 -----
2   	 3.5250e+00 	1.1244e-02 	1.2024e-03 	-9.3511e+00 	 ------- 	 ------- 	 -----
3   	 3.5250e+00 	1.3700e-06 	1.4654e-07 	-9.3488e+00 	 ------- 	 ------- 	 -----
x* =  [0.65873679]
Eigenvalues of Hessian at x* =  [-9.34881579+0.j]


***Case 2: Newton method with exact Hessian and line search***
Iter. 	f(x) 		||grad(x)|| 	||p|| 		min(eig(B)) 	alpha 		delta 		step
Line search failure. alpha =  0.9
0   	 1.5000e+00 	6.0000e+00 	6.7500e-01 	-8.0000e+00 	 9.00e-01 	 ------- 	 -----
Line search failure. alpha =  0.9
1   	 3.5238e+00 	1.5178e-01 	1.4663e-02 	-9.3163e+00 	 9.00e-01 	 ------- 	 -----
Line search failure. alpha =  0.9
2   	 3.5250e+00 	1.4959e-02 	1.4405e-03 	-9.3458e+00 	 9.00e-01 	 ------- 	 -----
Line search failure. alpha =  0.9
3   	 3.5250e+00 	1.4939e-03 	1.4382e-04 	-9.3485e+00 	 9.00e-01 	 ------- 	 -----
Line search failure. alpha =  0.9
4   	 3.5250e+00 	1.4937e-04 	1.4380e-05 	-9.3488e+00 	 9.00e-01 	 ------- 	 -----
Line search failure. alpha =  0.9
5   	 3.5250e+00 	1.4937e-05 	1.4379e-06 	-9.3488e+00 	 9.00e-01 	 ------- 	 -----
Line search failure. alpha =  0.9
6   	 3.5250e+00 	1.4937e-06 	1.4379e-07 	-9.3488e+00 	 9.00e-01 	 ------- 	 -----
x* =  [0.65873681]
Eigenvalues of Hessian at x* =  [-9.34881576+0.j]


***Case 3: Newton method with exact Hessian and trust region***
Iter. 	f(x) 		||grad(x)|| 	||p|| 		min(eig(B)) 	alpha 		delta 		step
0   	 1.5000e+00 	6.0000e+00 	7.5000e-01 	-8.0000e+00 	 ------- 	 2.00e+00 	 accept
1   	 3.4863e+00 	8.4375e-01 	9.2466e-02 	-9.1250e+00 	 ------- 	 2.00e+00 	 accept
2   	 3.5250e+00 	1.1244e-02 	1.2024e-03 	-9.3511e+00 	 ------- 	 2.00e+00 	 accept
3   	 3.5250e+00 	1.3700e-06 	1.4654e-07 	-9.3488e+00 	 ------- 	 2.00e+00 	 accept
x* =  [0.65873679]
Eigenvalues of Hessian at x* =  [-9.34881579+0.j]


***Case 4: Quasi-Newton method with SR1 Hessian approximation and no globalization strategy***
Iter. 	f(x) 		||grad(x)|| 	||p|| 		min(eig(B)) 	alpha 		delta 		step
0   	 1.5000e+00 	6.0000e+00 	6.0000e+00 	 1.0000e+00 	 ------- 	 ------- 	 -----
1   	 6.8550e+02 	4.8600e+02 	5.9268e+00 	 8.2000e+01 	 ------- 	 ------- 	 -----
2   	 1.0400e+00 	6.5685e+00 	7.9036e-02 	 8.3108e+01 	 ------- 	 ------- 	 -----
3   	 4.9789e-01 	7.1411e+00 	9.8572e-01 	-7.2446e+00 	 ------- 	 ------- 	 -----
4   	 3.3844e+00 	1.5942e+00 	1.7989e-01 	-8.8618e+00 	 ------- 	 ------- 	 -----
5   	 3.5249e+00 	4.7859e-02 	5.2432e-03 	-9.1279e+00 	 ------- 	 ------- 	 -----
6   	 3.5250e+00 	1.1831e-03 	1.2649e-04 	-9.3535e+00 	 ------- 	 ------- 	 -----
7   	 3.5250e+00 	6.0994e-07 	6.5210e-08 	-9.3535e+00 	 ------- 	 ------- 	 -----
x* =  [0.65873679]
Eigenvalues of Hessian at x* =  [-9.34881579+0.j]


***Case 5: Quasi-Newton method with SR1 Hessian approximation and line search***
Iter. 	f(x) 		||grad(x)|| 	||p|| 		min(eig(B)) 	alpha 		delta 		step
0   	 1.5000e+00 	6.0000e+00 	2.3245e+00 	 1.0000e+00 	 3.87e-01 	 ------- 	 -----
1   	-6.9020e+00 	1.6735e+01 	8.1839e-01 	 9.7804e+00 	 4.78e-01 	 ------- 	 -----
2   	-1.0621e+01 	4.4106e+00 	1.7070e-01 	 2.5838e+01 	 1.00e+00 	 ------- 	 -----
3   	-1.1140e+01 	1.5495e+00 	9.2452e-02 	 1.6760e+01 	 1.00e+00 	 ------- 	 -----
4   	-1.1199e+01 	3.1396e-01 	1.5576e-02 	 2.0156e+01 	 1.00e+00 	 ------- 	 -----
5   	-1.1201e+01 	1.6045e-02 	7.5733e-04 	 2.1186e+01 	 1.00e+00 	 ------- 	 -----
6   	-1.1201e+01 	1.5212e-04 	7.2490e-06 	 2.0986e+01 	 1.00e+00 	 ------- 	 -----
Line search failure. alpha =  0.7290000000000001
7   	-1.1201e+01 	7.4964e-08 	2.6041e-09 	 2.0986e+01 	 7.29e-01 	 ------- 	 -----
x* =  [-1.75447804]
Eigenvalues of Hessian at x* =  [20.99602745+0.j]


***Case 6: Quasi-Newton method with SR1 Hessian approximation and trust region***
Iter. 	f(x) 		||grad(x)|| 	||p|| 		min(eig(B)) 	alpha 		delta 		step
0   	 1.5000e+00 	6.0000e+00 	2.0000e+00 	 1.0000e+00 	 ------- 	 2.00e+00 	 accept
1   	-1.0500e+01 	6.0000e+00 	1.0000e+00 	 6.0000e+00 	 ------- 	 4.00e+00 	 reject
2   	-1.0500e+01 	6.0000e+00 	2.5000e-01 	 6.0000e+00 	 ------- 	 2.50e-01 	 accept
3   	-1.1201e+01 	9.3750e-02 	3.8462e-03 	 2.4375e+01 	 ------- 	 2.50e-01 	 accept
4   	-1.1201e+01 	1.3262e-02 	6.3371e-04 	 2.0927e+01 	 ------- 	 2.50e-01 	 accept
5   	-1.1201e+01 	3.8373e-05 	1.8284e-06 	 2.0988e+01 	 ------- 	 2.50e-01 	 accept
6   	-1.1201e+01 	1.5627e-08 	7.4456e-10 	 2.0988e+01 	 ------- 	 2.50e-01 	 reject
x* =  [-1.75447804]
Eigenvalues of Hessian at x* =  [20.99602741+0.j]


***Case 7: Quasi-Newton method with BFGS Hessian approximation and no globalization strategy***
Iter. 	f(x) 		||grad(x)|| 	||p|| 		min(eig(B)) 	alpha 		delta 		step
0   	 1.5000e+00 	6.0000e+00 	6.0000e+00 	 1.0000e+00 	 ------- 	 ------- 	 -----
1   	 6.8550e+02 	4.8600e+02 	5.9268e+00 	 8.2000e+01 	 ------- 	 ------- 	 -----
2   	 1.0400e+00 	6.5685e+00 	7.9036e-02 	 8.3108e+01 	 ------- 	 ------- 	 -----
3   	 4.9789e-01 	7.1411e+00 	8.5925e-02 	 8.3108e+01 	 ------- 	 ------- 	 -----
4   	-1.4051e-01 	7.7079e+00 	9.2746e-02 	 8.3108e+01 	 ------- 	 ------- 	 -----
5   	-8.8097e-01 	8.2461e+00 	9.9222e-02 	 8.3108e+01 	 ------- 	 ------- 	 -----
6   	-1.7239e+00 	8.7267e+00 	1.0500e-01 	 8.3108e+01 	 ------- 	 ------- 	 -----
7   	-2.6617e+00 	9.1154e+00 	1.0968e-01 	 8.3108e+01 	 ------- 	 ------- 	 -----
8   	-3.6772e+00 	9.3749e+00 	1.1280e-01 	 8.3108e+01 	 ------- 	 ------- 	 -----
9   	-4.7418e+00 	9.4693e+00 	1.1394e-01 	 8.3108e+01 	 ------- 	 ------- 	 -----
10   	-5.8169e+00 	9.3696e+00 	1.0710e+01 	 8.7485e-01 	 ------- 	 ------- 	 -----
11   	 9.9445e+03 	3.4106e+03 	1.0681e+01 	 3.1933e+02 	 ------- 	 ------- 	 -----
12   	-6.0910e+00 	9.3100e+00 	2.9076e-02 	 3.2020e+02 	 ------- 	 ------- 	 -----
13   	-6.3607e+00 	9.2367e+00 	3.6644e+00 	 2.5207e+00 	 ------- 	 ------- 	 -----
14   	 2.0926e+02 	2.1453e+02 	3.5132e+00 	 6.1064e+01 	 ------- 	 ------- 	 -----
15   	-7.7160e+00 	8.6147e+00 	1.3563e-01 	 6.3516e+01 	 ------- 	 ------- 	 -----
16   	-8.8258e+00 	7.6891e+00 	1.1266e+00 	 6.8249e+00 	 ------- 	 ------- 	 -----
17   	-6.5781e+00 	1.7468e+01 	7.8228e-01 	 2.2329e+01 	 ------- 	 ------- 	 -----
18   	-1.0841e+01 	3.5674e+00 	1.3267e-01 	 2.6889e+01 	 ------- 	 ------- 	 -----
19   	-1.1164e+01 	1.2235e+00 	6.9256e-02 	 1.7667e+01 	 ------- 	 ------- 	 -----
20   	-1.1201e+01 	1.8230e-01 	8.9808e-03 	 2.0299e+01 	 ------- 	 ------- 	 -----
21   	-1.1201e+01 	7.2657e-03 	3.4421e-04 	 2.1108e+01 	 ------- 	 ------- 	 -----
22   	-1.1201e+01 	4.0262e-05 	1.9180e-06 	 2.0991e+01 	 ------- 	 ------- 	 -----
23   	-1.1201e+01 	8.9798e-09 	4.2779e-10 	 2.0991e+01 	 ------- 	 ------- 	 -----
x* =  [-1.75447804]
Eigenvalues of Hessian at x* =  [20.99602743+0.j]


***Case 8: Quasi-Newton method with BFGS Hessian approximation and line search***
Iter. 	f(x) 		||grad(x)|| 	||p|| 		min(eig(B)) 	alpha 		delta 		step
0   	 1.5000e+00 	6.0000e+00 	2.3245e+00 	 1.0000e+00 	 3.87e-01 	 ------- 	 -----
1   	-6.9020e+00 	1.6735e+01 	8.1839e-01 	 9.7804e+00 	 4.78e-01 	 ------- 	 -----
2   	-1.0621e+01 	4.4106e+00 	1.7070e-01 	 2.5838e+01 	 1.00e+00 	 ------- 	 -----
3   	-1.1140e+01 	1.5495e+00 	9.2452e-02 	 1.6760e+01 	 1.00e+00 	 ------- 	 -----
4   	-1.1199e+01 	3.1396e-01 	1.5576e-02 	 2.0156e+01 	 1.00e+00 	 ------- 	 -----
5   	-1.1201e+01 	1.6045e-02 	7.5733e-04 	 2.1186e+01 	 1.00e+00 	 ------- 	 -----
6   	-1.1201e+01 	1.5212e-04 	7.2490e-06 	 2.0986e+01 	 1.00e+00 	 ------- 	 -----
Line search failure. alpha =  0.7290000000000001
7   	-1.1201e+01 	7.4964e-08 	2.6041e-09 	 2.0986e+01 	 7.29e-01 	 ------- 	 -----
x* =  [-1.75447804]
Eigenvalues of Hessian at x* =  [20.99602745+0.j]


***Case 9: Quasi-Newton method with BFGS Hessian approximation and trust region***
Iter. 	f(x) 		||grad(x)|| 	||p|| 		min(eig(B)) 	alpha 		delta 		step
0   	 1.5000e+00 	6.0000e+00 	2.0000e+00 	 1.0000e+00 	 ------- 	 2.00e+00 	 accept
1   	-1.0500e+01 	6.0000e+00 	1.0000e+00 	 6.0000e+00 	 ------- 	 4.00e+00 	 reject
2   	-1.0500e+01 	6.0000e+00 	2.5000e-01 	 6.0000e+00 	 ------- 	 2.50e-01 	 accept
3   	-1.1201e+01 	9.3750e-02 	3.8462e-03 	 2.4375e+01 	 ------- 	 2.50e-01 	 accept
4   	-1.1201e+01 	1.3262e-02 	6.3371e-04 	 2.0927e+01 	 ------- 	 2.50e-01 	 accept
5   	-1.1201e+01 	3.8373e-05 	1.8284e-06 	 2.0988e+01 	 ------- 	 2.50e-01 	 accept
6   	-1.1201e+01 	1.5627e-08 	7.4456e-10 	 2.0988e+01 	 ------- 	 2.50e-01 	 reject
x* =  [-1.75447804]
Eigenvalues of Hessian at x* =  [20.99602741+0.j]


***Case 10: Steepest Descent and line search***
Iter. 	f(x) 		||grad(x)|| 	||p|| 		min(eig(B)) 	alpha 		delta 		step
0   	 1.5000e+00 	6.0000e+00 	2.3245e+00 	 1.0000e+00 	 3.87e-01 	 ------- 	 -----
1   	-6.9020e+00 	1.6735e+01 	7.8823e-01 	 1.0000e+00 	 4.71e-02 	 ------- 	 -----
2   	-1.0747e+01 	3.9578e+00 	3.1570e-01 	 1.0000e+00 	 7.98e-02 	 ------- 	 -----
3   	-1.1097e+01 	2.1780e+00 	1.4072e-01 	 1.0000e+00 	 6.46e-02 	 ------- 	 -----
4   	-1.1182e+01 	8.8201e-01 	6.3319e-02 	 1.0000e+00 	 7.18e-02 	 ------- 	 -----
5   	-1.1197e+01 	4.2785e-01 	2.7644e-02 	 1.0000e+00 	 6.46e-02 	 ------- 	 -----
6   	-1.1201e+01 	1.5728e-01 	1.1291e-02 	 1.0000e+00 	 7.18e-02 	 ------- 	 -----
7   	-1.1201e+01 	7.9215e-02 	5.1182e-03 	 1.0000e+00 	 6.46e-02 	 ------- 	 -----
8   	-1.1201e+01 	2.8413e-02 	1.8358e-03 	 1.0000e+00 	 6.46e-02 	 ------- 	 -----
9   	-1.1201e+01 	1.0109e-02 	6.5318e-04 	 1.0000e+00 	 6.46e-02 	 ------- 	 -----
10   	-1.1201e+01 	3.6075e-03 	2.3308e-04 	 1.0000e+00 	 6.46e-02 	 ------- 	 -----
11   	-1.1201e+01 	1.2860e-03 	8.3088e-05 	 1.0000e+00 	 6.46e-02 	 ------- 	 -----
12   	-1.1201e+01 	4.5858e-04 	2.9629e-05 	 1.0000e+00 	 6.46e-02 	 ------- 	 -----
13   	-1.1201e+01 	1.6351e-04 	1.0565e-05 	 1.0000e+00 	 6.46e-02 	 ------- 	 -----
14   	-1.1201e+01 	5.8304e-05 	3.7671e-06 	 1.0000e+00 	 6.46e-02 	 ------- 	 -----
15   	-1.1201e+01 	2.0789e-05 	1.3432e-06 	 1.0000e+00 	 6.46e-02 	 ------- 	 -----
16   	-1.1201e+01 	7.4129e-06 	4.7895e-07 	 1.0000e+00 	 6.46e-02 	 ------- 	 -----
x* =  [-1.75447817]
Eigenvalues of Hessian at x* =  [20.99603083+0.j]
</pre></div>
</div>
</div>
</div>
<section id="id1">
<h4>Discussion<a class="headerlink" href="#id1" title="Link to this heading">#</a></h4>
<p>Which cases converged to a <strong>local maximizer</strong>?</p>
<p><strong>Answer:</strong></p>
<p>Which cases converged to a <strong>local minimizer</strong>?</p>
<p><strong>Answer:</strong></p>
<p>Based on these results, which algorithms do you recommend for non-convex problems?</p>
<p><strong>Answer:</strong></p>
</section>
</section>
<section id="return-of-example-2-19">
<h3>Return of Example 2.19<a class="headerlink" href="#return-of-example-2-19" title="Link to this heading">#</a></h3>
<p>Now we will benchmark the algorithms using <strong>Example 2.19</strong>.</p>
<p><img alt="ex2-19" src="https://raw.githubusercontent.com/ndcbe/optimization/main/media/ex2-19.png" /></p>
<p>Consider the function <span class="math notranslate nohighlight">\(g(z) = \sqrt{z}\)</span>, which is only defined for <span class="math notranslate nohighlight">\(z \geq 0\)</span>. We will shortly learn how handle bounds/inequality constraints in an optimization problem.</p>
<p>But for this assignment, we will focus on algorithms for <em>unconstrained</em> nonlinear optimization. We will use a smoothed approximation to ensure <span class="math notranslate nohighlight">\(g(z)\)</span> is defined and twice-differentiable over <span class="math notranslate nohighlight">\(z \in \mathbb{R}\)</span>. Consider:</p>
<div class="math notranslate nohighlight">
\[g(z) \approx \sqrt{\max(z,0)}\]</div>
<p>This ensures that <span class="math notranslate nohighlight">\(g(z)\)</span> is defined over <span class="math notranslate nohighlight">\(z \in \mathbb{R}\)</span>. But what about twice-differentiable? We will further approximate</p>
<div class="math notranslate nohighlight">
\[\max(z,0) \approx \frac{1}{2}\left(\sqrt{z^2 + 10^{-4}} + z \right)\]</div>
<p>Below is an implementation of the Example 2.19 that uses this smoothed approximation.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">asqrt</span><span class="p">(</span><span class="n">z</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Approximate/smoothed square root</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">z</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mf">1E-4</span><span class="p">)</span> <span class="o">+</span> <span class="n">z</span><span class="p">))</span>
    
<span class="k">def</span><span class="w"> </span><span class="nf">ex2_19_smoothed</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39; Evaluate function given above at point x</span>

<span class="sd">    Inputs:</span>
<span class="sd">        x - vector with 2 elements</span>
<span class="sd">        </span>
<span class="sd">    Outputs:</span>
<span class="sd">        f - function value (scalar)</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="c1"># Constants</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">])</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span> <span class="mi">26</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">40</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">])</span>
    
    <span class="c1"># Intermediates. Recall Python indicies start at 0</span>
    <span class="n">u</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mf">0.8</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">asqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">u</span><span class="p">)</span>
    <span class="n">s2</span> <span class="o">=</span> <span class="n">asqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">u</span><span class="p">)</span>
    <span class="n">v</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">u</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">s</span><span class="o">-</span><span class="n">a</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">u</span><span class="p">)</span>
    <span class="n">alpha</span> <span class="o">=</span> <span class="o">-</span><span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">u</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">s2</span><span class="o">+</span> <span class="n">b</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">u</span>
    <span class="n">beta</span> <span class="o">=</span> <span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">v</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">c</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">v</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">c</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">u</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    
    <span class="n">f</span> <span class="o">=</span> <span class="n">alpha</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">beta</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;##### my_f at x = &quot;</span><span class="p">,</span><span class="n">x</span><span class="p">,</span> <span class="s2">&quot;#####&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;u = &quot;</span><span class="p">,</span><span class="n">u</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;sqrt(1-u) = &quot;</span><span class="p">,</span><span class="n">s</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;sqrt(1+u) = &quot;</span><span class="p">,</span><span class="n">s2</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;v = &quot;</span><span class="p">,</span><span class="n">v</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;alpha = &quot;</span><span class="p">,</span><span class="n">alpha</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;beta = &quot;</span><span class="p">,</span><span class="n">beta</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;f(x) = &quot;</span><span class="p">,</span><span class="n">f</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;##### Done. #####</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">f</span>

<span class="n">my_f2</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">ex2_19_smoothed</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">my_grad2</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">my_grad_approx</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">my_f2</span><span class="p">,</span><span class="mf">1E-6</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">my_hes2</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">my_hes_approx</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">my_grad2</span><span class="p">,</span><span class="mf">1E-6</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<section id="benchmark-with-x-0-near-solution">
<h4>Benchmark with <span class="math notranslate nohighlight">\(x_0\)</span> Near Solution<a class="headerlink" href="#benchmark-with-x-0-near-solution" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">])</span>
<span class="n">benchmark</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span><span class="n">my_f2</span><span class="p">,</span><span class="n">my_grad2</span><span class="p">,</span><span class="n">my_hes2</span><span class="p">,</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>***Case 1: Newton method with exact Hessian and no globalization strategy***
Iter. 	f(x) 		||grad(x)|| 	||p|| 		min(eig(B)) 	alpha 		delta 		step
0   	-4.9246e+00 	1.0874e+01 	4.1947e-02 	 4.9370e+01 	 ------- 	 ------- 	 -----
1   	-5.0888e+00 	6.2734e-01 	1.9755e-03 	 4.2542e+01 	 ------- 	 ------- 	 -----
2   	-5.0893e+00 	2.4208e-03 	3.0022e-05 	 4.3424e+01 	 ------- 	 ------- 	 -----
3   	-5.0893e+00 	2.9175e-07 	3.1334e-09 	 4.3418e+01 	 ------- 	 ------- 	 -----
x* =  [0.73950642 0.31435986]
Eigenvalues of Hessian at x* =  [ 43.41806155+0.j 426.36193114+0.j]


***Case 2: Newton method with exact Hessian and line search***
Iter. 	f(x) 		||grad(x)|| 	||p|| 		min(eig(B)) 	alpha 		delta 		step
0   	-4.9246e+00 	1.0874e+01 	4.1947e-02 	 4.9370e+01 	 1.00e+00 	 ------- 	 -----
1   	-5.0888e+00 	6.2734e-01 	1.9755e-03 	 4.2542e+01 	 1.00e+00 	 ------- 	 -----
2   	-5.0893e+00 	2.4208e-03 	3.0022e-05 	 4.3424e+01 	 1.00e+00 	 ------- 	 -----
3   	-5.0893e+00 	2.9175e-07 	3.1334e-09 	 4.3418e+01 	 1.00e+00 	 ------- 	 -----
x* =  [0.73950642 0.31435986]
Eigenvalues of Hessian at x* =  [ 43.41806155+0.j 426.36193114+0.j]


***Case 3: Newton method with exact Hessian and trust region***
Iter. 	f(x) 		||grad(x)|| 	||p|| 		min(eig(B)) 	alpha 		delta 		step
0   	-4.9246e+00 	1.0874e+01 	4.1947e-02 	 4.9370e+01 	 ------- 	 2.00e+00 	 accept
1   	-5.0888e+00 	6.2734e-01 	1.9755e-03 	 4.2542e+01 	 ------- 	 2.00e+00 	 accept
2   	-5.0893e+00 	2.4208e-03 	3.0022e-05 	 4.3424e+01 	 ------- 	 2.00e+00 	 accept
3   	-5.0893e+00 	2.9175e-07 	3.1334e-09 	 4.3418e+01 	 ------- 	 2.00e+00 	 reject
x* =  [0.73950642 0.31435986]
Eigenvalues of Hessian at x* =  [ 43.41820666+0.j 426.36200807+0.j]


***Case 4: Quasi-Newton method with SR1 Hessian approximation and no globalization strategy***
Iter. 	f(x) 		||grad(x)|| 	||p|| 		min(eig(B)) 	alpha 		delta 		step
0   	-4.9246e+00 	1.0874e+01 	1.0874e+01 	 1.0000e+00 	 ------- 	 ------- 	 -----
Warning: Hessian approximation is near singular.
B[k] = 
 [[ 2.40566051e+93 -1.88095467e+93]
 [-1.88095467e+93  1.47069399e+93]]
x* =  [ 5.43705574 10.08833764]
Eigenvalues of Hessian at x* =  [ 8.63954930e+95+0.j -6.55410896e+91+0.j]


***Case 5: Quasi-Newton method with SR1 Hessian approximation and line search***
Iter. 	f(x) 		||grad(x)|| 	||p|| 		min(eig(B)) 	alpha 		delta 		step
0   	-4.9246e+00 	1.0874e+01 	3.6770e-02 	 1.0000e+00 	 3.38e-03 	 ------- 	 -----
1   	-5.0500e+00 	4.4205e+00 	4.4992e-02 	 1.0000e+00 	 3.82e-02 	 ------- 	 -----
2   	-5.0674e+00 	3.6723e+00 	1.8961e-02 	 3.7784e+01 	 1.00e+00 	 ------- 	 -----
3   	-5.0892e+00 	9.7210e-02 	2.4549e-04 	 3.7780e+01 	 1.00e+00 	 ------- 	 -----
4   	-5.0893e+00 	5.8514e-03 	4.0135e-05 	 3.9433e+01 	 1.00e+00 	 ------- 	 -----
5   	-5.0893e+00 	1.4377e-04 	3.2683e-06 	 4.3406e+01 	 1.00e+00 	 ------- 	 -----
6   	-5.0893e+00 	2.0937e-07 	1.1207e-09 	 4.3406e+01 	 1.00e+00 	 ------- 	 -----
x* =  [0.73950642 0.31435986]
Eigenvalues of Hessian at x* =  [ 43.41818718+0.j 426.3618055 +0.j]


***Case 6: Quasi-Newton method with SR1 Hessian approximation and trust region***
Iter. 	f(x) 		||grad(x)|| 	||p|| 		min(eig(B)) 	alpha 		delta 		step
0   	-4.9246e+00 	1.0874e+01 	2.0000e+00 	 1.0000e+00 	 ------- 	 2.00e+00 	 reject
1   	-4.9246e+00 	1.0874e+01 	5.0000e-01 	 1.0000e+00 	 ------- 	 5.00e-01 	 reject
2   	-4.9246e+00 	1.0874e+01 	1.2500e-01 	 1.0000e+00 	 ------- 	 1.25e-01 	 reject
3   	-4.9246e+00 	1.0874e+01 	3.1250e-02 	 1.0000e+00 	 ------- 	 3.12e-02 	 accept
4   	-5.0665e+00 	2.3568e+00 	3.1250e-02 	 1.0000e+00 	 ------- 	 3.12e-02 	 accept
5   	-5.0881e+00 	9.8076e-01 	3.0776e-03 	 4.0771e+01 	 ------- 	 3.12e-02 	 accept
6   	-5.0892e+00 	4.6629e-02 	4.8788e-04 	 4.4036e+01 	 ------- 	 3.12e-02 	 accept
7   	-5.0893e+00 	5.4140e-04 	8.7158e-06 	 4.3387e+01 	 ------- 	 3.12e-02 	 accept
8   	-5.0893e+00 	1.7327e-06 	1.1790e-08 	 4.3387e+01 	 ------- 	 3.12e-02 	 accept
x* =  [0.73950642 0.31435986]
Eigenvalues of Hessian at x* =  [ 43.41840922+0.j 426.36202755+0.j]


***Case 7: Quasi-Newton method with BFGS Hessian approximation and no globalization strategy***
Iter. 	f(x) 		||grad(x)|| 	||p|| 		min(eig(B)) 	alpha 		delta 		step
0   	-4.9246e+00 	1.0874e+01 	1.0874e+01 	 1.0000e+00 	 ------- 	 ------- 	 -----
Warning: Hessian approximation is near singular.
B[k] = 
 [[ 2.40566051e+93 -1.88095467e+93]
 [-1.88095467e+93  1.47069399e+93]]
x* =  [ 5.43705574 10.08833764]
Eigenvalues of Hessian at x* =  [ 8.63954930e+95+0.j -6.55410896e+91+0.j]


***Case 8: Quasi-Newton method with BFGS Hessian approximation and line search***
Iter. 	f(x) 		||grad(x)|| 	||p|| 		min(eig(B)) 	alpha 		delta 		step
0   	-4.9246e+00 	1.0874e+01 	3.6770e-02 	 1.0000e+00 	 3.38e-03 	 ------- 	 -----
1   	-5.0500e+00 	4.4205e+00 	4.5530e-02 	 9.8819e-01 	 3.82e-02 	 ------- 	 -----
2   	-5.0671e+00 	3.6634e+00 	1.9685e-02 	 3.7814e+01 	 1.00e+00 	 ------- 	 -----
3   	-5.0893e+00 	8.3284e-03 	2.0822e-04 	 3.8028e+01 	 1.00e+00 	 ------- 	 -----
4   	-5.0893e+00 	1.6840e-03 	2.6639e-05 	 4.3370e+01 	 1.00e+00 	 ------- 	 -----
5   	-5.0893e+00 	3.4725e-05 	8.9062e-08 	 4.3207e+01 	 1.00e+00 	 ------- 	 -----
x* =  [0.73950642 0.31435986]
Eigenvalues of Hessian at x* =  [ 43.41837027+0.j 426.36162242+0.j]


***Case 9: Quasi-Newton method with BFGS Hessian approximation and trust region***
Iter. 	f(x) 		||grad(x)|| 	||p|| 		min(eig(B)) 	alpha 		delta 		step
0   	-4.9246e+00 	1.0874e+01 	2.0000e+00 	 1.0000e+00 	 ------- 	 2.00e+00 	 reject
1   	-4.9246e+00 	1.0874e+01 	5.0000e-01 	 1.0000e+00 	 ------- 	 5.00e-01 	 reject
2   	-4.9246e+00 	1.0874e+01 	1.2500e-01 	 1.0000e+00 	 ------- 	 1.25e-01 	 reject
3   	-4.9246e+00 	1.0874e+01 	3.1250e-02 	 1.0000e+00 	 ------- 	 3.12e-02 	 accept
4   	-5.0665e+00 	2.3568e+00 	3.1250e-02 	 9.8768e-01 	 ------- 	 3.12e-02 	 accept
5   	-5.0881e+00 	9.8103e-01 	3.1250e-02 	 6.6632e+00 	 ------- 	 3.12e-02 	 reject
6   	-5.0881e+00 	9.8103e-01 	7.8125e-03 	 6.6632e+00 	 ------- 	 7.81e-03 	 reject
7   	-5.0881e+00 	9.8103e-01 	1.9531e-03 	 6.6632e+00 	 ------- 	 1.95e-03 	 accept
8   	-5.0892e+00 	1.5608e-01 	1.9531e-03 	 7.0647e+00 	 ------- 	 1.95e-03 	 accept
9   	-5.0892e+00 	2.7758e-02 	7.6768e-04 	 3.0614e+01 	 ------- 	 1.95e-03 	 accept
10   	-5.0893e+00 	4.1299e-02 	1.9410e-04 	 4.1031e+01 	 ------- 	 1.95e-03 	 accept
11   	-5.0893e+00 	2.1703e-02 	8.1046e-05 	 3.6818e+01 	 ------- 	 1.95e-03 	 accept
12   	-5.0893e+00 	9.3297e-04 	1.7774e-05 	 3.9135e+01 	 ------- 	 1.95e-03 	 accept
13   	-5.0893e+00 	1.0689e-04 	1.5964e-06 	 4.3341e+01 	 ------- 	 1.95e-03 	 accept
14   	-5.0893e+00 	4.6643e-06 	1.3806e-08 	 4.3341e+01 	 ------- 	 1.95e-03 	 accept
x* =  [0.73950642 0.31435986]
Eigenvalues of Hessian at x* =  [ 43.41838974+0.j 426.36182498+0.j]


***Case 10: Steepest Descent and line search***
Iter. 	f(x) 		||grad(x)|| 	||p|| 		min(eig(B)) 	alpha 		delta 		step
0   	-4.9246e+00 	1.0874e+01 	3.6770e-02 	 1.0000e+00 	 3.38e-03 	 ------- 	 -----
1   	-5.0500e+00 	4.4205e+00 	1.6608e-02 	 1.0000e+00 	 3.76e-03 	 ------- 	 -----
2   	-5.0703e+00 	2.5775e+00 	9.6841e-03 	 1.0000e+00 	 3.76e-03 	 ------- 	 -----
3   	-5.0783e+00 	1.6164e+00 	7.4976e-03 	 1.0000e+00 	 4.64e-03 	 ------- 	 -----
4   	-5.0815e+00 	1.4787e+00 	6.1731e-03 	 1.0000e+00 	 4.17e-03 	 ------- 	 -----
5   	-5.0842e+00 	1.1500e+00 	4.8006e-03 	 1.0000e+00 	 4.17e-03 	 ------- 	 -----
6   	-5.0859e+00 	8.9734e-01 	4.1622e-03 	 1.0000e+00 	 4.64e-03 	 ------- 	 -----
7   	-5.0869e+00 	8.2888e-01 	3.4602e-03 	 1.0000e+00 	 4.17e-03 	 ------- 	 -----
8   	-5.0877e+00 	6.4810e-01 	2.7055e-03 	 1.0000e+00 	 4.17e-03 	 ------- 	 -----
9   	-5.0883e+00 	5.0889e-01 	2.1244e-03 	 1.0000e+00 	 4.17e-03 	 ------- 	 -----
10   	-5.0886e+00 	4.0020e-01 	1.8563e-03 	 1.0000e+00 	 4.64e-03 	 ------- 	 -----
11   	-5.0888e+00 	3.7147e-01 	1.5507e-03 	 1.0000e+00 	 4.17e-03 	 ------- 	 -----
12   	-5.0890e+00 	2.9181e-01 	1.2182e-03 	 1.0000e+00 	 4.17e-03 	 ------- 	 -----
13   	-5.0891e+00 	2.2973e-01 	9.5903e-04 	 1.0000e+00 	 4.17e-03 	 ------- 	 -----
14   	-5.0891e+00 	1.8105e-01 	7.5581e-04 	 1.0000e+00 	 4.17e-03 	 ------- 	 -----
15   	-5.0892e+00 	1.4294e-01 	6.6299e-04 	 1.0000e+00 	 4.64e-03 	 ------- 	 -----
16   	-5.0892e+00 	1.3277e-01 	5.5425e-04 	 1.0000e+00 	 4.17e-03 	 ------- 	 -----
17   	-5.0892e+00 	1.0457e-01 	4.3654e-04 	 1.0000e+00 	 4.17e-03 	 ------- 	 -----
18   	-5.0892e+00 	8.2435e-02 	3.4413e-04 	 1.0000e+00 	 4.17e-03 	 ------- 	 -----
19   	-5.0892e+00 	6.5066e-02 	2.7162e-04 	 1.0000e+00 	 4.17e-03 	 ------- 	 -----
20   	-5.0892e+00 	5.1406e-02 	2.3844e-04 	 1.0000e+00 	 4.64e-03 	 ------- 	 -----
21   	-5.0892e+00 	4.7773e-02 	1.9943e-04 	 1.0000e+00 	 4.17e-03 	 ------- 	 -----
22   	-5.0893e+00 	3.7645e-02 	1.5715e-04 	 1.0000e+00 	 4.17e-03 	 ------- 	 -----
23   	-5.0893e+00 	2.9694e-02 	1.2396e-04 	 1.0000e+00 	 4.17e-03 	 ------- 	 -----
24   	-5.0893e+00 	2.3443e-02 	9.7864e-05 	 1.0000e+00 	 4.17e-03 	 ------- 	 -----
25   	-5.0893e+00 	1.8527e-02 	8.5936e-05 	 1.0000e+00 	 4.64e-03 	 ------- 	 -----
26   	-5.0893e+00 	1.7227e-02 	7.1917e-05 	 1.0000e+00 	 4.17e-03 	 ------- 	 -----
27   	-5.0893e+00 	1.3578e-02 	5.6681e-05 	 1.0000e+00 	 4.17e-03 	 ------- 	 -----
28   	-5.0893e+00 	1.0710e-02 	4.4711e-05 	 1.0000e+00 	 4.17e-03 	 ------- 	 -----
29   	-5.0893e+00 	8.4562e-03 	3.5301e-05 	 1.0000e+00 	 4.17e-03 	 ------- 	 -----
30   	-5.0893e+00 	6.6826e-03 	3.0997e-05 	 1.0000e+00 	 4.64e-03 	 ------- 	 -----
31   	-5.0893e+00 	6.2174e-03 	2.5955e-05 	 1.0000e+00 	 4.17e-03 	 ------- 	 -----
32   	-5.0893e+00 	4.8999e-03 	2.0455e-05 	 1.0000e+00 	 4.17e-03 	 ------- 	 -----
33   	-5.0893e+00 	3.8650e-03 	1.6134e-05 	 1.0000e+00 	 4.17e-03 	 ------- 	 -----
34   	-5.0893e+00 	3.0512e-03 	1.2738e-05 	 1.0000e+00 	 4.17e-03 	 ------- 	 -----
35   	-5.0893e+00 	2.4111e-03 	1.1184e-05 	 1.0000e+00 	 4.64e-03 	 ------- 	 -----
36   	-5.0893e+00 	2.2445e-03 	9.3697e-06 	 1.0000e+00 	 4.17e-03 	 ------- 	 -----
37   	-5.0893e+00 	1.7687e-03 	7.3837e-06 	 1.0000e+00 	 4.17e-03 	 ------- 	 -----
38   	-5.0893e+00 	1.3950e-03 	5.8235e-06 	 1.0000e+00 	 4.17e-03 	 ------- 	 -----
39   	-5.0893e+00 	1.1012e-03 	4.5969e-06 	 1.0000e+00 	 4.17e-03 	 ------- 	 -----
40   	-5.0893e+00 	8.7002e-04 	4.0355e-06 	 1.0000e+00 	 4.64e-03 	 ------- 	 -----
41   	-5.0893e+00 	8.1036e-04 	3.3829e-06 	 1.0000e+00 	 4.17e-03 	 ------- 	 -----
42   	-5.0893e+00 	6.3853e-04 	2.6656e-06 	 1.0000e+00 	 4.17e-03 	 ------- 	 -----
43   	-5.0893e+00 	5.0354e-04 	2.1020e-06 	 1.0000e+00 	 4.17e-03 	 ------- 	 -----
44   	-5.0893e+00 	3.9742e-04 	1.6591e-06 	 1.0000e+00 	 4.17e-03 	 ------- 	 -----
45   	-5.0893e+00 	3.1396e-04 	1.4563e-06 	 1.0000e+00 	 4.64e-03 	 ------- 	 -----
46   	-5.0893e+00 	2.9259e-04 	1.2215e-06 	 1.0000e+00 	 4.17e-03 	 ------- 	 -----
47   	-5.0893e+00 	2.3052e-04 	9.6233e-07 	 1.0000e+00 	 4.17e-03 	 ------- 	 -----
x* =  [0.73950438 0.31436011]
Eigenvalues of Hessian at x* =  [ 43.41886108+0.j 426.36201978+0.j]
</pre></div>
</div>
</div>
</div>
</section>
<section id="id2">
<h4>Discussion<a class="headerlink" href="#id2" title="Link to this heading">#</a></h4>
<p>Which cases do not converge to the known solution?</p>
<p><strong>Answer:</strong></p>
<p>What is happening with the SR1 and BFGS update when no globalization strategy is used? <em>Hint:</em> This is related to the square root approximation.</p>
<p><strong>Answer:</strong></p>
</section>
<section id="benchmark-with-x-0-far-from-the-solution">
<h4>Benchmark with <span class="math notranslate nohighlight">\(x_0\)</span> Far From the Solution<a class="headerlink" href="#benchmark-with-x-0-far-from-the-solution" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">])</span>
<span class="n">benchmark</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span><span class="n">my_f2</span><span class="p">,</span><span class="n">my_grad2</span><span class="p">,</span><span class="n">my_hes2</span><span class="p">,</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>***Case 1: Newton method with exact Hessian and no globalization strategy***
Iter. 	f(x) 		||grad(x)|| 	||p|| 		min(eig(B)) 	alpha 		delta 		step
0   	 1.7116e-06 	1.5723e-04 	3.8594e-02 	-2.9410e-03 	 ------- 	 ------- 	 -----
1   	 5.7117e-07 	5.5951e-05 	3.6202e-02 	-1.0859e-03 	 ------- 	 ------- 	 -----
2   	 1.9240e-07 	1.9977e-05 	3.4172e-02 	-4.0313e-04 	 ------- 	 ------- 	 -----
3   	 6.5310e-08 	7.1521e-06 	3.2420e-02 	-1.5022e-04 	 ------- 	 ------- 	 -----
4   	 2.2312e-08 	2.5663e-06 	3.0889e-02 	-5.6122e-05 	 ------- 	 ------- 	 -----
5   	 7.6637e-09 	9.2257e-07 	2.9536e-02 	-2.1007e-05 	 ------- 	 ------- 	 -----
x* =  [-0.00313333 -0.20178778]
Eigenvalues of Hessian at x* =  [ 1.45576374e-05+0.j -7.87341863e-06+0.j]


***Case 2: Newton method with exact Hessian and line search***
Iter. 	f(x) 		||grad(x)|| 	||p|| 		min(eig(B)) 	alpha 		delta 		step
0   	 1.7116e-06 	1.5723e-04 	3.8594e-02 	-2.9410e-03 	 1.00e+00 	 ------- 	 -----
1   	 5.7117e-07 	5.5951e-05 	3.6202e-02 	-1.0859e-03 	 1.00e+00 	 ------- 	 -----
2   	 1.9240e-07 	1.9977e-05 	3.4172e-02 	-4.0313e-04 	 1.00e+00 	 ------- 	 -----
3   	 6.5310e-08 	7.1521e-06 	3.2420e-02 	-1.5022e-04 	 1.00e+00 	 ------- 	 -----
4   	 2.2312e-08 	2.5663e-06 	3.0889e-02 	-5.6122e-05 	 1.00e+00 	 ------- 	 -----
5   	 7.6637e-09 	9.2257e-07 	2.9536e-02 	-2.1007e-05 	 1.00e+00 	 ------- 	 -----
x* =  [-0.00313333 -0.20178778]
Eigenvalues of Hessian at x* =  [ 1.45576374e-05+0.j -7.87341863e-06+0.j]


***Case 3: Newton method with exact Hessian and trust region***
Iter. 	f(x) 		||grad(x)|| 	||p|| 		min(eig(B)) 	alpha 		delta 		step
0   	 1.7116e-06 	1.5723e-04 	3.8594e-02 	-2.9410e-03 	 ------- 	 2.00e+00 	 accept
1   	 5.7117e-07 	5.5951e-05 	3.6202e-02 	-1.0859e-03 	 ------- 	 2.00e+00 	 accept
2   	 1.9240e-07 	1.9977e-05 	3.4172e-02 	-4.0313e-04 	 ------- 	 2.00e+00 	 accept
3   	 6.5310e-08 	7.1521e-06 	3.2420e-02 	-1.5022e-04 	 ------- 	 2.00e+00 	 accept
4   	 2.2312e-08 	2.5663e-06 	3.0889e-02 	-5.6122e-05 	 ------- 	 2.00e+00 	 accept
5   	 7.6637e-09 	9.2257e-07 	2.9536e-02 	-2.1007e-05 	 ------- 	 2.00e+00 	 accept
x* =  [-0.00313333 -0.20178778]
Eigenvalues of Hessian at x* =  [ 1.45576374e-05+0.j -7.87341863e-06+0.j]


***Case 4: Quasi-Newton method with SR1 Hessian approximation and no globalization strategy***
Iter. 	f(x) 		||grad(x)|| 	||p|| 		min(eig(B)) 	alpha 		delta 		step
0   	 1.7116e-06 	1.5723e-04 	1.5723e-04 	 1.0000e+00 	 ------- 	 ------- 	 -----
1   	 1.6869e-06 	1.5677e-04 	5.3086e-02 	 2.9530e-03 	 ------- 	 ------- 	 -----
2   	-2.3989e-06 	7.2336e-05 	4.0934e-03 	 2.7417e-03 	 ------- 	 ------- 	 -----
3   	-2.4364e-06 	7.1078e-05 	3.7770e-03 	 1.5844e-03 	 ------- 	 ------- 	 -----
4   	-2.4551e-06 	7.0156e-05 	1.6393e-03 	 1.4153e-03 	 ------- 	 ------- 	 -----
5   	-2.4788e-06 	7.0331e-05 	7.1786e-02 	 8.7441e-04 	 ------- 	 ------- 	 -----
6   	-1.3803e-05 	3.5715e-04 	7.7165e-02 	-4.7635e-03 	 ------- 	 ------- 	 -----
7   	-1.8335e-06 	5.2108e-05 	1.2853e-02 	-4.0717e-03 	 ------- 	 ------- 	 -----
8   	-1.2703e-06 	3.6881e-05 	3.1009e-02 	-1.1894e-03 	 ------- 	 ------- 	 -----
9   	-5.0534e-07 	1.5390e-05 	2.2172e-02 	-6.9356e-04 	 ------- 	 ------- 	 -----
10   	-2.5506e-07 	8.0241e-06 	2.4104e-02 	-3.3191e-04 	 ------- 	 ------- 	 -----
11   	-1.1847e-07 	3.8571e-06 	2.2260e-02 	-1.7236e-04 	 ------- 	 ------- 	 -----
12   	-5.7063e-08 	1.9164e-06 	2.1932e-02 	-8.6740e-05 	 ------- 	 ------- 	 -----
13   	-2.7199e-08 	9.4119e-07 	2.1123e-02 	-4.4158e-05 	 ------- 	 ------- 	 -----
x* =  [-0.08873597 -0.1844557 ]
Eigenvalues of Hessian at x* =  [ 3.41429300e-06+0.j -1.58482887e-05+0.j]


***Case 5: Quasi-Newton method with SR1 Hessian approximation and line search***
Iter. 	f(x) 		||grad(x)|| 	||p|| 		min(eig(B)) 	alpha 		delta 		step
0   	 1.7116e-06 	1.5723e-04 	1.5723e-04 	 1.0000e+00 	 1.00e+00 	 ------- 	 -----
1   	 1.6869e-06 	1.5677e-04 	5.3086e-02 	 2.9530e-03 	 1.00e+00 	 ------- 	 -----
2   	-2.3989e-06 	7.2336e-05 	4.0934e-03 	 2.7417e-03 	 1.00e+00 	 ------- 	 -----
3   	-2.4364e-06 	7.1078e-05 	3.7770e-03 	 1.5844e-03 	 1.00e+00 	 ------- 	 -----
4   	-2.4551e-06 	7.0156e-05 	1.6393e-03 	 1.4153e-03 	 1.00e+00 	 ------- 	 -----
5   	-2.4788e-06 	7.0331e-05 	7.1786e-02 	 8.7441e-04 	 1.00e+00 	 ------- 	 -----
Line search failure. alpha =  0.9
6   	-1.3803e-05 	3.5715e-04 	6.9449e-02 	-4.7635e-03 	 9.00e-01 	 ------- 	 -----
Line search failure. alpha =  4.353241455684411e-14
7   	-2.2680e-06 	6.3846e-05 	6.4013e-16 	-4.3566e-03 	 4.35e-14 	 ------- 	 -----
x* =  [-0.08201558 -0.02174002]
Eigenvalues of Hessian at x* =  [ 0.00067133+0.j -0.00170098+0.j]


***Case 6: Quasi-Newton method with SR1 Hessian approximation and trust region***
Iter. 	f(x) 		||grad(x)|| 	||p|| 		min(eig(B)) 	alpha 		delta 		step
0   	 1.7116e-06 	1.5723e-04 	1.5723e-04 	 1.0000e+00 	 ------- 	 2.00e+00 	 accept
1   	 1.6869e-06 	1.5677e-04 	5.3086e-02 	 2.9530e-03 	 ------- 	 2.00e+00 	 accept
2   	-2.3989e-06 	7.2336e-05 	4.0934e-03 	 2.7417e-03 	 ------- 	 2.00e+00 	 accept
3   	-2.4364e-06 	7.1078e-05 	3.7770e-03 	 1.5844e-03 	 ------- 	 2.00e+00 	 accept
4   	-2.4551e-06 	7.0156e-05 	1.6393e-03 	 1.4153e-03 	 ------- 	 2.00e+00 	 accept
5   	-2.4788e-06 	7.0331e-05 	7.1786e-02 	 8.7441e-04 	 ------- 	 2.00e+00 	 accept
6   	-1.3803e-05 	3.5715e-04 	7.7165e-02 	-4.7635e-03 	 ------- 	 2.00e+00 	 accept
7   	-1.8335e-06 	5.2108e-05 	1.2853e-02 	-4.0717e-03 	 ------- 	 2.00e+00 	 accept
8   	-1.2703e-06 	3.6881e-05 	3.1009e-02 	-1.1894e-03 	 ------- 	 2.00e+00 	 accept
9   	-5.0534e-07 	1.5390e-05 	2.2172e-02 	-6.9356e-04 	 ------- 	 2.00e+00 	 accept
10   	-2.5506e-07 	8.0241e-06 	2.4104e-02 	-3.3191e-04 	 ------- 	 2.00e+00 	 accept
11   	-1.1847e-07 	3.8571e-06 	2.2260e-02 	-1.7236e-04 	 ------- 	 2.00e+00 	 accept
12   	-5.7063e-08 	1.9164e-06 	2.1932e-02 	-8.6740e-05 	 ------- 	 2.00e+00 	 accept
13   	-2.7199e-08 	9.4119e-07 	2.1123e-02 	-4.4158e-05 	 ------- 	 2.00e+00 	 accept
x* =  [-0.08873597 -0.1844557 ]
Eigenvalues of Hessian at x* =  [ 3.41429300e-06+0.j -1.58482887e-05+0.j]


***Case 7: Quasi-Newton method with BFGS Hessian approximation and no globalization strategy***
Iter. 	f(x) 		||grad(x)|| 	||p|| 		min(eig(B)) 	alpha 		delta 		step
0   	 1.7116e-06 	1.5723e-04 	1.5723e-04 	 1.0000e+00 	 ------- 	 ------- 	 -----
1   	 1.6869e-06 	1.5677e-04 	5.3086e-02 	 2.9531e-03 	 ------- 	 ------- 	 -----
2   	-2.3988e-06 	7.2335e-05 	4.0930e-03 	 2.7417e-03 	 ------- 	 ------- 	 -----
3   	-2.4363e-06 	7.1075e-05 	3.7674e-03 	 1.5843e-03 	 ------- 	 ------- 	 -----
4   	-2.4541e-06 	7.0132e-05 	1.4838e-03 	 1.4144e-03 	 ------- 	 ------- 	 -----
5   	-2.4625e-06 	6.9939e-05 	1.3871e-04 	 1.4144e-03 	 ------- 	 ------- 	 -----
6   	-2.4692e-06 	7.0090e-05 	9.6823e-05 	 1.4144e-03 	 ------- 	 ------- 	 -----
7   	-2.4760e-06 	7.0270e-05 	9.8466e-05 	 1.4144e-03 	 ------- 	 ------- 	 -----
8   	-2.4828e-06 	7.0453e-05 	9.8927e-05 	 1.4144e-03 	 ------- 	 ------- 	 -----
9   	-2.4897e-06 	7.0637e-05 	9.9206e-05 	 1.4144e-03 	 ------- 	 ------- 	 -----
10   	-2.4965e-06 	7.0822e-05 	9.9468e-05 	 1.4144e-03 	 ------- 	 ------- 	 -----
11   	-2.5035e-06 	7.1008e-05 	9.9729e-05 	 1.4144e-03 	 ------- 	 ------- 	 -----
12   	-2.5104e-06 	7.1195e-05 	9.9992e-05 	 1.4144e-03 	 ------- 	 ------- 	 -----
13   	-2.5174e-06 	7.1383e-05 	1.0026e-04 	 1.4144e-03 	 ------- 	 ------- 	 -----
14   	-2.5244e-06 	7.1572e-05 	1.0052e-04 	 1.4144e-03 	 ------- 	 ------- 	 -----
15   	-2.5315e-06 	7.1762e-05 	1.0079e-04 	 1.4144e-03 	 ------- 	 ------- 	 -----
16   	-2.5386e-06 	7.1952e-05 	1.0105e-04 	 1.4144e-03 	 ------- 	 ------- 	 -----
17   	-2.5458e-06 	7.2144e-05 	1.0132e-04 	 1.4144e-03 	 ------- 	 ------- 	 -----
18   	-2.5529e-06 	7.2337e-05 	1.0159e-04 	 1.4144e-03 	 ------- 	 ------- 	 -----
19   	-2.5602e-06 	7.2531e-05 	1.0187e-04 	 1.4144e-03 	 ------- 	 ------- 	 -----
20   	-2.5674e-06 	7.2726e-05 	1.0214e-04 	 1.4144e-03 	 ------- 	 ------- 	 -----
21   	-2.5747e-06 	7.2922e-05 	1.0241e-04 	 1.4144e-03 	 ------- 	 ------- 	 -----
22   	-2.5820e-06 	7.3119e-05 	1.0269e-04 	 1.4144e-03 	 ------- 	 ------- 	 -----
23   	-2.5894e-06 	7.3316e-05 	1.0297e-04 	 1.4144e-03 	 ------- 	 ------- 	 -----
24   	-2.5968e-06 	7.3515e-05 	1.0325e-04 	 1.4144e-03 	 ------- 	 ------- 	 -----
25   	-2.6043e-06 	7.3715e-05 	1.0353e-04 	 1.4144e-03 	 ------- 	 ------- 	 -----
26   	-2.6118e-06 	7.3916e-05 	1.0381e-04 	 1.4144e-03 	 ------- 	 ------- 	 -----
27   	-2.6193e-06 	7.4119e-05 	1.0409e-04 	 1.4144e-03 	 ------- 	 ------- 	 -----
28   	-2.6269e-06 	7.4322e-05 	1.0438e-04 	 1.4144e-03 	 ------- 	 ------- 	 -----
29   	-2.6345e-06 	7.4526e-05 	1.0467e-04 	 1.4144e-03 	 ------- 	 ------- 	 -----
30   	-2.6422e-06 	7.4731e-05 	1.0495e-04 	 1.4144e-03 	 ------- 	 ------- 	 -----
31   	-2.6499e-06 	7.4938e-05 	1.0524e-04 	 1.4144e-03 	 ------- 	 ------- 	 -----
32   	-2.6576e-06 	7.5146e-05 	1.0553e-04 	 1.4144e-03 	 ------- 	 ------- 	 -----
33   	-2.6654e-06 	7.5354e-05 	1.0583e-04 	 1.4144e-03 	 ------- 	 ------- 	 -----
34   	-2.6733e-06 	7.5564e-05 	1.0612e-04 	 1.4144e-03 	 ------- 	 ------- 	 -----
35   	-2.6811e-06 	7.5775e-05 	1.0642e-04 	 1.4144e-03 	 ------- 	 ------- 	 -----
36   	-2.6891e-06 	7.5987e-05 	1.0672e-04 	 1.4144e-03 	 ------- 	 ------- 	 -----
37   	-2.6970e-06 	7.6201e-05 	1.0701e-04 	 1.4144e-03 	 ------- 	 ------- 	 -----
38   	-2.7050e-06 	7.6415e-05 	1.0732e-04 	 1.4144e-03 	 ------- 	 ------- 	 -----
39   	-2.7131e-06 	7.6631e-05 	1.0762e-04 	 1.4144e-03 	 ------- 	 ------- 	 -----
40   	-2.7212e-06 	7.6847e-05 	1.0792e-04 	 1.4144e-03 	 ------- 	 ------- 	 -----
41   	-2.7293e-06 	7.7065e-05 	1.0823e-04 	 1.4144e-03 	 ------- 	 ------- 	 -----
42   	-2.7375e-06 	7.7285e-05 	1.0854e-04 	 1.4144e-03 	 ------- 	 ------- 	 -----
43   	-2.7458e-06 	7.7505e-05 	1.0884e-04 	 1.4144e-03 	 ------- 	 ------- 	 -----
44   	-2.7541e-06 	7.7727e-05 	1.0916e-04 	 1.4144e-03 	 ------- 	 ------- 	 -----
45   	-2.7624e-06 	7.7949e-05 	1.0947e-04 	 1.4144e-03 	 ------- 	 ------- 	 -----
46   	-2.7708e-06 	7.8174e-05 	1.0978e-04 	 1.4144e-03 	 ------- 	 ------- 	 -----
47   	-2.7792e-06 	7.8399e-05 	1.1010e-04 	 1.4144e-03 	 ------- 	 ------- 	 -----
48   	-2.7877e-06 	7.8625e-05 	1.1042e-04 	 1.4144e-03 	 ------- 	 ------- 	 -----
49   	-2.7962e-06 	7.8853e-05 	1.1074e-04 	 1.4144e-03 	 ------- 	 ------- 	 -----
Reached maximum number of iterations.
x* =  [-0.06054287 -0.01247025]
Eigenvalues of Hessian at x* =  [ 0.00145694+0.j -0.00207929+0.j]


***Case 8: Quasi-Newton method with BFGS Hessian approximation and line search***
Iter. 	f(x) 		||grad(x)|| 	||p|| 		min(eig(B)) 	alpha 		delta 		step
0   	 1.7116e-06 	1.5723e-04 	1.5723e-04 	 1.0000e+00 	 1.00e+00 	 ------- 	 -----
1   	 1.6869e-06 	1.5677e-04 	5.3086e-02 	 2.9531e-03 	 1.00e+00 	 ------- 	 -----
2   	-2.3988e-06 	7.2335e-05 	4.0930e-03 	 2.7417e-03 	 1.00e+00 	 ------- 	 -----
3   	-2.4363e-06 	7.1075e-05 	3.7674e-03 	 1.5843e-03 	 1.00e+00 	 ------- 	 -----
4   	-2.4541e-06 	7.0132e-05 	1.4838e-03 	 1.4144e-03 	 1.00e+00 	 ------- 	 -----
5   	-2.4625e-06 	6.9939e-05 	1.3871e-04 	 1.4144e-03 	 1.00e+00 	 ------- 	 -----
6   	-2.4692e-06 	7.0090e-05 	9.6823e-05 	 1.4144e-03 	 1.00e+00 	 ------- 	 -----
7   	-2.4760e-06 	7.0270e-05 	9.8466e-05 	 1.4144e-03 	 1.00e+00 	 ------- 	 -----
8   	-2.4828e-06 	7.0453e-05 	9.8927e-05 	 1.4144e-03 	 1.00e+00 	 ------- 	 -----
9   	-2.4897e-06 	7.0637e-05 	9.9206e-05 	 1.4144e-03 	 1.00e+00 	 ------- 	 -----
10   	-2.4965e-06 	7.0822e-05 	9.9468e-05 	 1.4144e-03 	 1.00e+00 	 ------- 	 -----
11   	-2.5035e-06 	7.1008e-05 	9.9729e-05 	 1.4144e-03 	 1.00e+00 	 ------- 	 -----
12   	-2.5104e-06 	7.1195e-05 	9.9992e-05 	 1.4144e-03 	 1.00e+00 	 ------- 	 -----
13   	-2.5174e-06 	7.1383e-05 	1.0026e-04 	 1.4144e-03 	 1.00e+00 	 ------- 	 -----
14   	-2.5244e-06 	7.1572e-05 	1.0052e-04 	 1.4144e-03 	 1.00e+00 	 ------- 	 -----
15   	-2.5315e-06 	7.1762e-05 	1.0079e-04 	 1.4144e-03 	 1.00e+00 	 ------- 	 -----
16   	-2.5386e-06 	7.1952e-05 	1.0105e-04 	 1.4144e-03 	 1.00e+00 	 ------- 	 -----
17   	-2.5458e-06 	7.2144e-05 	1.0132e-04 	 1.4144e-03 	 1.00e+00 	 ------- 	 -----
18   	-2.5529e-06 	7.2337e-05 	1.0159e-04 	 1.4144e-03 	 1.00e+00 	 ------- 	 -----
19   	-2.5602e-06 	7.2531e-05 	1.0187e-04 	 1.4144e-03 	 1.00e+00 	 ------- 	 -----
20   	-2.5674e-06 	7.2726e-05 	1.0214e-04 	 1.4144e-03 	 1.00e+00 	 ------- 	 -----
21   	-2.5747e-06 	7.2922e-05 	1.0241e-04 	 1.4144e-03 	 1.00e+00 	 ------- 	 -----
22   	-2.5820e-06 	7.3119e-05 	1.0269e-04 	 1.4144e-03 	 1.00e+00 	 ------- 	 -----
23   	-2.5894e-06 	7.3316e-05 	1.0297e-04 	 1.4144e-03 	 1.00e+00 	 ------- 	 -----
24   	-2.5968e-06 	7.3515e-05 	1.0325e-04 	 1.4144e-03 	 1.00e+00 	 ------- 	 -----
25   	-2.6043e-06 	7.3715e-05 	1.0353e-04 	 1.4144e-03 	 1.00e+00 	 ------- 	 -----
26   	-2.6118e-06 	7.3916e-05 	1.0381e-04 	 1.4144e-03 	 1.00e+00 	 ------- 	 -----
27   	-2.6193e-06 	7.4119e-05 	1.0409e-04 	 1.4144e-03 	 1.00e+00 	 ------- 	 -----
28   	-2.6269e-06 	7.4322e-05 	1.0438e-04 	 1.4144e-03 	 1.00e+00 	 ------- 	 -----
29   	-2.6345e-06 	7.4526e-05 	1.0467e-04 	 1.4144e-03 	 1.00e+00 	 ------- 	 -----
30   	-2.6422e-06 	7.4731e-05 	1.0495e-04 	 1.4144e-03 	 1.00e+00 	 ------- 	 -----
31   	-2.6499e-06 	7.4938e-05 	1.0524e-04 	 1.4144e-03 	 1.00e+00 	 ------- 	 -----
32   	-2.6576e-06 	7.5146e-05 	1.0553e-04 	 1.4144e-03 	 1.00e+00 	 ------- 	 -----
33   	-2.6654e-06 	7.5354e-05 	1.0583e-04 	 1.4144e-03 	 1.00e+00 	 ------- 	 -----
34   	-2.6733e-06 	7.5564e-05 	1.0612e-04 	 1.4144e-03 	 1.00e+00 	 ------- 	 -----
35   	-2.6811e-06 	7.5775e-05 	1.0642e-04 	 1.4144e-03 	 1.00e+00 	 ------- 	 -----
36   	-2.6891e-06 	7.5987e-05 	1.0672e-04 	 1.4144e-03 	 1.00e+00 	 ------- 	 -----
37   	-2.6970e-06 	7.6201e-05 	1.0701e-04 	 1.4144e-03 	 1.00e+00 	 ------- 	 -----
38   	-2.7050e-06 	7.6415e-05 	1.0732e-04 	 1.4144e-03 	 1.00e+00 	 ------- 	 -----
39   	-2.7131e-06 	7.6631e-05 	1.0762e-04 	 1.4144e-03 	 1.00e+00 	 ------- 	 -----
40   	-2.7212e-06 	7.6847e-05 	1.0792e-04 	 1.4144e-03 	 1.00e+00 	 ------- 	 -----
41   	-2.7293e-06 	7.7065e-05 	1.0823e-04 	 1.4144e-03 	 1.00e+00 	 ------- 	 -----
42   	-2.7375e-06 	7.7285e-05 	1.0854e-04 	 1.4144e-03 	 1.00e+00 	 ------- 	 -----
43   	-2.7458e-06 	7.7505e-05 	1.0884e-04 	 1.4144e-03 	 1.00e+00 	 ------- 	 -----
44   	-2.7541e-06 	7.7727e-05 	1.0916e-04 	 1.4144e-03 	 1.00e+00 	 ------- 	 -----
45   	-2.7624e-06 	7.7949e-05 	1.0947e-04 	 1.4144e-03 	 1.00e+00 	 ------- 	 -----
46   	-2.7708e-06 	7.8174e-05 	1.0978e-04 	 1.4144e-03 	 1.00e+00 	 ------- 	 -----
47   	-2.7792e-06 	7.8399e-05 	1.1010e-04 	 1.4144e-03 	 1.00e+00 	 ------- 	 -----
48   	-2.7877e-06 	7.8625e-05 	1.1042e-04 	 1.4144e-03 	 1.00e+00 	 ------- 	 -----
49   	-2.7962e-06 	7.8853e-05 	1.1074e-04 	 1.4144e-03 	 1.00e+00 	 ------- 	 -----
Reached maximum number of iterations.
x* =  [-0.06054287 -0.01247025]
Eigenvalues of Hessian at x* =  [ 0.00145694+0.j -0.00207929+0.j]


***Case 9: Quasi-Newton method with BFGS Hessian approximation and trust region***
Iter. 	f(x) 		||grad(x)|| 	||p|| 		min(eig(B)) 	alpha 		delta 		step
0   	 1.7116e-06 	1.5723e-04 	1.5723e-04 	 1.0000e+00 	 ------- 	 2.00e+00 	 accept
1   	 1.6869e-06 	1.5677e-04 	5.3086e-02 	 2.9531e-03 	 ------- 	 2.00e+00 	 accept
2   	-2.3988e-06 	7.2335e-05 	4.0930e-03 	 2.7417e-03 	 ------- 	 2.00e+00 	 accept
3   	-2.4363e-06 	7.1075e-05 	3.7674e-03 	 1.5843e-03 	 ------- 	 2.00e+00 	 accept
4   	-2.4541e-06 	7.0132e-05 	1.4838e-03 	 1.4144e-03 	 ------- 	 2.00e+00 	 accept
5   	-2.4625e-06 	6.9939e-05 	1.3871e-04 	 1.4144e-03 	 ------- 	 2.00e+00 	 accept
6   	-2.4692e-06 	7.0090e-05 	9.6823e-05 	 1.4144e-03 	 ------- 	 2.00e+00 	 accept
7   	-2.4760e-06 	7.0270e-05 	9.8466e-05 	 1.4144e-03 	 ------- 	 2.00e+00 	 accept
8   	-2.4828e-06 	7.0453e-05 	9.8927e-05 	 1.4144e-03 	 ------- 	 2.00e+00 	 accept
9   	-2.4897e-06 	7.0637e-05 	9.9206e-05 	 1.4144e-03 	 ------- 	 2.00e+00 	 accept
10   	-2.4965e-06 	7.0822e-05 	9.9468e-05 	 1.4144e-03 	 ------- 	 2.00e+00 	 accept
11   	-2.5035e-06 	7.1008e-05 	9.9729e-05 	 1.4144e-03 	 ------- 	 2.00e+00 	 accept
12   	-2.5104e-06 	7.1195e-05 	9.9992e-05 	 1.4144e-03 	 ------- 	 2.00e+00 	 accept
13   	-2.5174e-06 	7.1383e-05 	1.0026e-04 	 1.4144e-03 	 ------- 	 2.00e+00 	 accept
14   	-2.5244e-06 	7.1572e-05 	1.0052e-04 	 1.4144e-03 	 ------- 	 2.00e+00 	 accept
15   	-2.5315e-06 	7.1762e-05 	1.0079e-04 	 1.4144e-03 	 ------- 	 2.00e+00 	 accept
16   	-2.5386e-06 	7.1952e-05 	1.0105e-04 	 1.4144e-03 	 ------- 	 2.00e+00 	 accept
17   	-2.5458e-06 	7.2144e-05 	1.0132e-04 	 1.4144e-03 	 ------- 	 2.00e+00 	 accept
18   	-2.5529e-06 	7.2337e-05 	1.0159e-04 	 1.4144e-03 	 ------- 	 2.00e+00 	 accept
19   	-2.5602e-06 	7.2531e-05 	1.0187e-04 	 1.4144e-03 	 ------- 	 2.00e+00 	 accept
20   	-2.5674e-06 	7.2726e-05 	1.0214e-04 	 1.4144e-03 	 ------- 	 2.00e+00 	 accept
21   	-2.5747e-06 	7.2922e-05 	1.0241e-04 	 1.4144e-03 	 ------- 	 2.00e+00 	 accept
22   	-2.5820e-06 	7.3119e-05 	1.0269e-04 	 1.4144e-03 	 ------- 	 2.00e+00 	 accept
23   	-2.5894e-06 	7.3316e-05 	1.0297e-04 	 1.4144e-03 	 ------- 	 2.00e+00 	 accept
24   	-2.5968e-06 	7.3515e-05 	1.0325e-04 	 1.4144e-03 	 ------- 	 2.00e+00 	 accept
25   	-2.6043e-06 	7.3715e-05 	1.0353e-04 	 1.4144e-03 	 ------- 	 2.00e+00 	 accept
26   	-2.6118e-06 	7.3916e-05 	1.0381e-04 	 1.4144e-03 	 ------- 	 2.00e+00 	 accept
27   	-2.6193e-06 	7.4119e-05 	1.0409e-04 	 1.4144e-03 	 ------- 	 2.00e+00 	 accept
28   	-2.6269e-06 	7.4322e-05 	1.0438e-04 	 1.4144e-03 	 ------- 	 2.00e+00 	 accept
29   	-2.6345e-06 	7.4526e-05 	1.0467e-04 	 1.4144e-03 	 ------- 	 2.00e+00 	 accept
30   	-2.6422e-06 	7.4731e-05 	1.0495e-04 	 1.4144e-03 	 ------- 	 2.00e+00 	 accept
31   	-2.6499e-06 	7.4938e-05 	1.0524e-04 	 1.4144e-03 	 ------- 	 2.00e+00 	 accept
32   	-2.6576e-06 	7.5146e-05 	1.0553e-04 	 1.4144e-03 	 ------- 	 2.00e+00 	 accept
33   	-2.6654e-06 	7.5354e-05 	1.0583e-04 	 1.4144e-03 	 ------- 	 2.00e+00 	 accept
34   	-2.6733e-06 	7.5564e-05 	1.0612e-04 	 1.4144e-03 	 ------- 	 2.00e+00 	 accept
35   	-2.6811e-06 	7.5775e-05 	1.0642e-04 	 1.4144e-03 	 ------- 	 2.00e+00 	 accept
36   	-2.6891e-06 	7.5987e-05 	1.0672e-04 	 1.4144e-03 	 ------- 	 2.00e+00 	 accept
37   	-2.6970e-06 	7.6201e-05 	1.0701e-04 	 1.4144e-03 	 ------- 	 2.00e+00 	 accept
38   	-2.7050e-06 	7.6415e-05 	1.0732e-04 	 1.4144e-03 	 ------- 	 2.00e+00 	 accept
39   	-2.7131e-06 	7.6631e-05 	1.0762e-04 	 1.4144e-03 	 ------- 	 2.00e+00 	 accept
40   	-2.7212e-06 	7.6847e-05 	1.0792e-04 	 1.4144e-03 	 ------- 	 2.00e+00 	 accept
41   	-2.7293e-06 	7.7065e-05 	1.0823e-04 	 1.4144e-03 	 ------- 	 2.00e+00 	 accept
42   	-2.7375e-06 	7.7285e-05 	1.0854e-04 	 1.4144e-03 	 ------- 	 2.00e+00 	 accept
43   	-2.7458e-06 	7.7505e-05 	1.0884e-04 	 1.4144e-03 	 ------- 	 2.00e+00 	 accept
44   	-2.7541e-06 	7.7727e-05 	1.0916e-04 	 1.4144e-03 	 ------- 	 2.00e+00 	 accept
45   	-2.7624e-06 	7.7949e-05 	1.0947e-04 	 1.4144e-03 	 ------- 	 2.00e+00 	 accept
46   	-2.7708e-06 	7.8174e-05 	1.0978e-04 	 1.4144e-03 	 ------- 	 2.00e+00 	 accept
47   	-2.7792e-06 	7.8399e-05 	1.1010e-04 	 1.4144e-03 	 ------- 	 2.00e+00 	 accept
48   	-2.7877e-06 	7.8625e-05 	1.1042e-04 	 1.4144e-03 	 ------- 	 2.00e+00 	 accept
49   	-2.7962e-06 	7.8853e-05 	1.1074e-04 	 1.4144e-03 	 ------- 	 2.00e+00 	 accept
Reached maximum number of iterations.
x* =  [-0.06054287 -0.01247025]
Eigenvalues of Hessian at x* =  [ 0.00145694+0.j -0.00207929+0.j]


***Case 10: Steepest Descent and line search***
Iter. 	f(x) 		||grad(x)|| 	||p|| 		min(eig(B)) 	alpha 		delta 		step
0   	 1.7116e-06 	1.5723e-04 	1.5723e-04 	 1.0000e+00 	 1.00e+00 	 ------- 	 -----
1   	 1.6869e-06 	1.5677e-04 	1.5677e-04 	 1.0000e+00 	 1.00e+00 	 ------- 	 -----
2   	 1.6624e-06 	1.5630e-04 	1.5630e-04 	 1.0000e+00 	 1.00e+00 	 ------- 	 -----
3   	 1.6380e-06 	1.5585e-04 	1.5585e-04 	 1.0000e+00 	 1.00e+00 	 ------- 	 -----
4   	 1.6137e-06 	1.5539e-04 	1.5539e-04 	 1.0000e+00 	 1.00e+00 	 ------- 	 -----
5   	 1.5896e-06 	1.5494e-04 	1.5494e-04 	 1.0000e+00 	 1.00e+00 	 ------- 	 -----
6   	 1.5657e-06 	1.5449e-04 	1.5449e-04 	 1.0000e+00 	 1.00e+00 	 ------- 	 -----
7   	 1.5418e-06 	1.5405e-04 	1.5405e-04 	 1.0000e+00 	 1.00e+00 	 ------- 	 -----
8   	 1.5181e-06 	1.5360e-04 	1.5360e-04 	 1.0000e+00 	 1.00e+00 	 ------- 	 -----
9   	 1.4946e-06 	1.5317e-04 	1.5317e-04 	 1.0000e+00 	 1.00e+00 	 ------- 	 -----
10   	 1.4711e-06 	1.5273e-04 	1.5273e-04 	 1.0000e+00 	 1.00e+00 	 ------- 	 -----
11   	 1.4479e-06 	1.5230e-04 	1.5230e-04 	 1.0000e+00 	 1.00e+00 	 ------- 	 -----
12   	 1.4247e-06 	1.5187e-04 	1.5187e-04 	 1.0000e+00 	 1.00e+00 	 ------- 	 -----
13   	 1.4017e-06 	1.5144e-04 	1.5144e-04 	 1.0000e+00 	 1.00e+00 	 ------- 	 -----
14   	 1.3788e-06 	1.5102e-04 	1.5102e-04 	 1.0000e+00 	 1.00e+00 	 ------- 	 -----
15   	 1.3560e-06 	1.5060e-04 	1.5060e-04 	 1.0000e+00 	 1.00e+00 	 ------- 	 -----
16   	 1.3333e-06 	1.5019e-04 	1.5019e-04 	 1.0000e+00 	 1.00e+00 	 ------- 	 -----
17   	 1.3108e-06 	1.4977e-04 	1.4977e-04 	 1.0000e+00 	 1.00e+00 	 ------- 	 -----
18   	 1.2884e-06 	1.4937e-04 	1.4937e-04 	 1.0000e+00 	 1.00e+00 	 ------- 	 -----
19   	 1.2661e-06 	1.4896e-04 	1.4896e-04 	 1.0000e+00 	 1.00e+00 	 ------- 	 -----
20   	 1.2440e-06 	1.4856e-04 	1.4856e-04 	 1.0000e+00 	 1.00e+00 	 ------- 	 -----
21   	 1.2219e-06 	1.4816e-04 	1.4816e-04 	 1.0000e+00 	 1.00e+00 	 ------- 	 -----
22   	 1.2000e-06 	1.4776e-04 	1.4776e-04 	 1.0000e+00 	 1.00e+00 	 ------- 	 -----
23   	 1.1782e-06 	1.4737e-04 	1.4737e-04 	 1.0000e+00 	 1.00e+00 	 ------- 	 -----
24   	 1.1565e-06 	1.4697e-04 	1.4697e-04 	 1.0000e+00 	 1.00e+00 	 ------- 	 -----
25   	 1.1349e-06 	1.4659e-04 	1.4659e-04 	 1.0000e+00 	 1.00e+00 	 ------- 	 -----
26   	 1.1135e-06 	1.4620e-04 	1.4620e-04 	 1.0000e+00 	 1.00e+00 	 ------- 	 -----
27   	 1.0921e-06 	1.4582e-04 	1.4582e-04 	 1.0000e+00 	 1.00e+00 	 ------- 	 -----
28   	 1.0709e-06 	1.4544e-04 	1.4544e-04 	 1.0000e+00 	 1.00e+00 	 ------- 	 -----
29   	 1.0498e-06 	1.4507e-04 	1.4507e-04 	 1.0000e+00 	 1.00e+00 	 ------- 	 -----
30   	 1.0288e-06 	1.4469e-04 	1.4469e-04 	 1.0000e+00 	 1.00e+00 	 ------- 	 -----
31   	 1.0078e-06 	1.4432e-04 	1.4432e-04 	 1.0000e+00 	 1.00e+00 	 ------- 	 -----
32   	 9.8704e-07 	1.4396e-04 	1.4396e-04 	 1.0000e+00 	 1.00e+00 	 ------- 	 -----
33   	 9.6634e-07 	1.4359e-04 	1.4359e-04 	 1.0000e+00 	 1.00e+00 	 ------- 	 -----
34   	 9.4575e-07 	1.4323e-04 	1.4323e-04 	 1.0000e+00 	 1.00e+00 	 ------- 	 -----
35   	 9.2526e-07 	1.4288e-04 	1.4288e-04 	 1.0000e+00 	 1.00e+00 	 ------- 	 -----
36   	 9.0487e-07 	1.4252e-04 	1.4252e-04 	 1.0000e+00 	 1.00e+00 	 ------- 	 -----
37   	 8.8459e-07 	1.4217e-04 	1.4217e-04 	 1.0000e+00 	 1.00e+00 	 ------- 	 -----
38   	 8.6440e-07 	1.4182e-04 	1.4182e-04 	 1.0000e+00 	 1.00e+00 	 ------- 	 -----
39   	 8.4431e-07 	1.4147e-04 	1.4147e-04 	 1.0000e+00 	 1.00e+00 	 ------- 	 -----
40   	 8.2432e-07 	1.4113e-04 	1.4113e-04 	 1.0000e+00 	 1.00e+00 	 ------- 	 -----
41   	 8.0443e-07 	1.4079e-04 	1.4079e-04 	 1.0000e+00 	 1.00e+00 	 ------- 	 -----
42   	 7.8463e-07 	1.4045e-04 	1.4045e-04 	 1.0000e+00 	 1.00e+00 	 ------- 	 -----
43   	 7.6493e-07 	1.4012e-04 	1.4012e-04 	 1.0000e+00 	 1.00e+00 	 ------- 	 -----
44   	 7.4532e-07 	1.3979e-04 	1.3979e-04 	 1.0000e+00 	 1.00e+00 	 ------- 	 -----
45   	 7.2580e-07 	1.3946e-04 	1.3946e-04 	 1.0000e+00 	 1.00e+00 	 ------- 	 -----
46   	 7.0637e-07 	1.3913e-04 	1.3913e-04 	 1.0000e+00 	 1.00e+00 	 ------- 	 -----
47   	 6.8704e-07 	1.3881e-04 	1.3881e-04 	 1.0000e+00 	 1.00e+00 	 ------- 	 -----
48   	 6.6779e-07 	1.3848e-04 	1.3848e-04 	 1.0000e+00 	 1.00e+00 	 ------- 	 -----
49   	 6.4864e-07 	1.3817e-04 	1.3817e-04 	 1.0000e+00 	 1.00e+00 	 ------- 	 -----
Reached maximum number of iterations.
x* =  [-0.00719019 -0.00150696]
Eigenvalues of Hessian at x* =  [ 0.00452569+0.j -0.00268313+0.j]
</pre></div>
</div>
</div>
</div>
</section>
<section id="id3">
<h4>Discussion<a class="headerlink" href="#id3" title="Link to this heading">#</a></h4>
<p>Did any of the 10 cases converge to the known solution?</p>
<p>What do you recommend trying next to more reliably solve this particular problem?</p>
</section>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./notebooks/assignments"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../../org/project2.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Project 2</p>
      </div>
    </a>
    <a class="right-next"
       href="Algorithms4.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Algorithms Homework 4</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pseudocode">Pseudocode</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#unconstrained-nlp-algorithm-in-python">Unconstrained NLP Algorithm in Python</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#library-of-helper-functions">Library of Helper Functions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#main-function">Main Function</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#feature-status">Feature Status</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sr1">SR1</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#bfgs">BFGS</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#line-search">Line Search</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#trust-region">Trust Region</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#benchmark-tests">Benchmark Tests</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#quadratic-test-problem">Quadratic Test Problem</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#benchmark-cases">Benchmark Cases</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#discussion-and-analysis">Discussion and Analysis</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#one-dimensional-example">One-Dimensional Example</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#benchmark-cases-with-x-0-3">Benchmark Cases with <span class="math notranslate nohighlight">\(x_0 = -3\)</span></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#discussion">Discussion</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#benchmark-case-with-x-0-0">Benchmark Case with <span class="math notranslate nohighlight">\(x_0 = 0\)</span></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Discussion</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#return-of-example-2-19">Return of Example 2.19</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#benchmark-with-x-0-near-solution">Benchmark with <span class="math notranslate nohighlight">\(x_0\)</span> Near Solution</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Discussion</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#benchmark-with-x-0-far-from-the-solution">Benchmark with <span class="math notranslate nohighlight">\(x_0\)</span> Far From the Solution</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">Discussion</a></li>
</ul>
</li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Alexander Dowling, et al.
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      Â© Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>